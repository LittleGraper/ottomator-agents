---
title: "Trace downstream"
description: "The TraceDownstream request is used to determine the flow path in a downstream direction from the identified location."
slug: "trace-downstream"
url: "/trace-downstream"
guid: "GUID-1788EF28-A66C-44F5-8949-125A69C30CE0"
migratedTopicMetadata:
  FTITLE: "Trace Downstream"
  FDESCRIPTION: ""
  FCHANGES: "Update name to sentence case based on guideline for new developer site changes"
  FISHRELEASELABEL: ""
  FESRISOFTWARERELEASE: ""
  FESRITAGCLOUD: ""
  FESRIRECREATIONPROCEDURE: ""
  FESRIPRODUCTLIFECYCLE: "10.9.1 - *"
  CREATED-ON: "28/02/2022 13:24:27"
  FAUTHOR: "schatterjee"
  FSTATUS: "Released"
  MODIFIED-ON: "01/03/2022 14:22:48"
  VERSION: "13"
  FRESOLUTION: ""
  DOC-LANGUAGE: "en"
  FISHREVCOUNTER: "10"
  ED: "GUID-FE3EA69A-1125-4516-BBB1-3300FEA12844"
  FUSERGROUP: "VUSERGROUPSPATIALANALYSTDOC"
  READ-ACCESS: "VUSERGROUPGEOPROCESSINGDOC, VUSERGROUPGEOPROCESSINGTOOLDOC, VUSERGROUPSPATIALANALYSTDOC"
---

import GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_112D57CA_7296_4CFF_A67E_B19CF2362F34 from "./snippets/GUID-D5A128FE-89FD-4ECE-8925-14AF23433254/_GUID-112D57CA-7296-4CFF-A67E-B19CF2362F34";
import GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_3354841A_305A_45BE_BA13_A7EE9BA5077E from "./snippets/GUID-D5A128FE-89FD-4ECE-8925-14AF23433254/_GUID-3354841A-305A-45BE-BA13-A7EE9BA5077E";
import GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_F2A0992F_87C5_4B08_B9B6_9B3952194696 from "./snippets/GUID-D5A128FE-89FD-4ECE-8925-14AF23433254/_GUID-F2A0992F-87C5-4B08-B9B6-9B3952194696";
import GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_1EC796C9_59D7_4307_A9FB_ACE98BDCBE9E from "./snippets/GUID-D5A128FE-89FD-4ECE-8925-14AF23433254/_GUID-1EC796C9-59D7-4307-A9FB-ACE98BDCBE9E";
import GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_202CBB28_872B_4A5D_BB01_CC67D7F95EA0 from "./snippets/GUID-D5A128FE-89FD-4ECE-8925-14AF23433254/_GUID-202CBB28-872B-4A5D-BB01-CC67D7F95EA0";
import GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_94883572_93CF_4FF7_B068_EFA064F5A2D0 from "./snippets/GUID-D5A128FE-89FD-4ECE-8925-14AF23433254/_GUID-94883572-93CF-4FF7-B068-EFA064F5A2D0";
import GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_7CC9D3C7_2A6D_4E97_9961_D68064A6E171 from "./snippets/GUID-D5A128FE-89FD-4ECE-8925-14AF23433254/_GUID-7CC9D3C7-2A6D-4E97-9961-D68064A6E171";
import GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_706206B3_0DBD_4751_ABA4_535FCE86C5CF from "./snippets/GUID-D5A128FE-89FD-4ECE-8925-14AF23433254/_GUID-706206B3-0DBD-4751-ABA4-535FCE86C5CF";
import GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_LI_7EC4035791204CCDA9941641CC45D71B from "./snippets/GUID-D5A128FE-89FD-4ECE-8925-14AF23433254/_LI_7EC4035791204CCDA9941641CC45D71B";
import GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_4F3643B5_7AFB_4231_9BC9_9CD627B970D3 from "./snippets/GUID-D5A128FE-89FD-4ECE-8925-14AF23433254/_GUID-4F3643B5-7AFB-4231-9BC9-9CD627B970D3";
import GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_ED27927A_EB87_4A68_8366_F1C5B9800C56 from "./snippets/GUID-D5A128FE-89FD-4ECE-8925-14AF23433254/_GUID-ED27927A-EB87-4A68-8366-F1C5B9800C56";
import GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_C880F68F_D2D3_4373_9EFE_60817B4A8E9F from "./snippets/GUID-D5A128FE-89FD-4ECE-8925-14AF23433254/_GUID-C880F68F-D2D3-4373-9EFE-60817B4A8E9F";
import GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_LI_D2139681A87140C587DE1809DC56BD3A from "./snippets/GUID-D5A128FE-89FD-4ECE-8925-14AF23433254/_LI_D2139681A87140C587DE1809DC56BD3A";
import GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_LI_B8E1885CD4F14B768D67AD3C9BBFCDF8 from "./snippets/GUID-D5A128FE-89FD-4ECE-8925-14AF23433254/_LI_B8E1885CD4F14B768D67AD3C9BBFCDF8";
import GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_LI_8471304607D54A678FB4CACC465B2DEC from "./snippets/GUID-D5A128FE-89FD-4ECE-8925-14AF23433254/_LI_8471304607D54A678FB4CACC465B2DEC";
import GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_LI_ECE3A5EBB8084C61B7A46E03C76B3295 from "./snippets/GUID-D5A128FE-89FD-4ECE-8925-14AF23433254/_LI_ECE3A5EBB8084C61B7A46E03C76B3295";
import GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_LI_5670E0DAA771495C8D71E492B0D3E056 from "./snippets/GUID-D5A128FE-89FD-4ECE-8925-14AF23433254/_LI_5670E0DAA771495C8D71E492B0D3E056";
import GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_LI_EA9150B251534B0AA4B1A362793B6F31 from "./snippets/GUID-D5A128FE-89FD-4ECE-8925-14AF23433254/_LI_EA9150B251534B0AA4B1A362793B6F31";
import GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_5356A6DF_6F6A_41EF_9C2D_E71FE8CC7062 from "./snippets/GUID-D5A128FE-89FD-4ECE-8925-14AF23433254/_GUID-5356A6DF-6F6A-41EF-9C2D-E71FE8CC7062";
import GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_D4574F98_5D00_467C_BE89_524529F67768 from "./snippets/GUID-D5A128FE-89FD-4ECE-8925-14AF23433254/_GUID-D4574F98-5D00-467C-BE89-524529F67768";
import GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_7481CF75_D411_4A63_BA85_01E8F0C58F67 from "./snippets/GUID-D5A128FE-89FD-4ECE-8925-14AF23433254/_GUID-7481CF75-D411-4A63-BA85-01E8F0C58F67";
import GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_ED11CCC7_40D3_4ADD_A679_A3F6964834ED from "./snippets/GUID-D5A128FE-89FD-4ECE-8925-14AF23433254/_GUID-ED11CCC7-40D3-4ADD-A679-A3F6964834ED";
import GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_03071520_C169_41C0_8E51_866D82061408 from "./snippets/GUID-D5A128FE-89FD-4ECE-8925-14AF23433254/_GUID-03071520-C169-41C0-8E51-866D82061408";
import GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_F342A761_1C2C_49DB_8F5F_0978382ABA2B from "./snippets/GUID-D5A128FE-89FD-4ECE-8925-14AF23433254/_GUID-F342A761-1C2C-49DB-8F5F-0978382ABA2B";
import GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_887B283C_08BE_4F01_BF45_8AC1F629C885 from "./snippets/GUID-D5A128FE-89FD-4ECE-8925-14AF23433254/_GUID-887B283C-08BE-4F01-BF45-8AC1F629C885";
import GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_870D7B6F_ADE6_4B6A_BF5D_5F77154C9CD1 from "./snippets/GUID-D5A128FE-89FD-4ECE-8925-14AF23433254/_GUID-870D7B6F-ADE6-4B6A-BF5D-5F77154C9CD1";

![Trace Downstream request](./images/GUID-7D6CD97D-E397-47E9-9889-80AA8338EDC5-web.png)

The `TraceDownstream`  request is used to determine the flow path in a downstream direction from the identified location.

## Request URL

```
https://hydro.arcgis.com/arcgis/rest/services/Tools/Hydrology/GPServer/TraceDownstream/submitJob
```

 

## Description

The Trace Downstream request is used to delineate the downstream path from a particular location that you specify. It uses Esri-curated data to create an output polyline delineating the flow path downstream from that location.

<GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_112D57CA_7296_4CFF_A67E_B19CF2362F34 />

## Usage

-   For each input point, a downstream trace line feature will be returned.
-   An output downstream trace is the downstream path to the ocean. For example, an input point anywhere in the Mississippi River watershed will result in a down stream trace that ends in the Gulf of Mexico.
-   A downstream trace feature will not be returned if the point does not fall inside the extent of the specified data source.
-   <GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_3354841A_305A_45BE_BA13_A7EE9BA5077E />
-   <GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_F2A0992F_87C5_4B08_B9B6_9B3952194696 />
-   <GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_1EC796C9_59D7_4307_A9FB_ACE98BDCBE9E />
-   The output downstream trace feature dataset has a field called `PointID`  consisting of the values supplied in the point identification field. This allows the downstream trace to easily be related back to the input points.
-   The resulting downstream trace feature dataset contains a field called `LengthKm` , which is the length in kilometers for each downstream trace.
-   <GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_202CBB28_872B_4A5D_BB01_CC67D7F95EA0 />

## Request Parameters

<StyledTable headers={"Parameter,Description"}>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">
      `InputPoints` 
      (Required)
    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">
      The point features used for the starting location of a downstream trace.
      -   <GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_94883572_93CF_4FF7_B068_EFA064F5A2D0 />
    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">
      `PointIDField` 
      (Optional)
    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">
      <GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_7CC9D3C7_2A6D_4E97_9961_D68064A6E171 />
      <GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_706206B3_0DBD_4751_ABA4_535FCE86C5CF />
      -   <GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_LI_7EC4035791204CCDA9941641CC45D71B />
    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">
      `DataSourceResolution` 
    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">
      <GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_4F3643B5_7AFB_4231_9BC9_9CD627B970D3 />
      <GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_ED27927A_EB87_4A68_8366_F1C5B9800C56 />
      -   <GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_LI_7EC4035791204CCDA9941641CC45D71B />
      -   <GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_C880F68F_D2D3_4373_9EFE_60817B4A8E9F />
          -   <GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_LI_D2139681A87140C587DE1809DC56BD3A />
          -   <GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_LI_B8E1885CD4F14B768D67AD3C9BBFCDF8 />
          -   <GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_LI_8471304607D54A678FB4CACC465B2DEC />
          -   <GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_LI_ECE3A5EBB8084C61B7A46E03C76B3295 />
          -   <GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_LI_5670E0DAA771495C8D71E492B0D3E056 />
    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">
      `Generalize` 
    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">
      Determines if the output downstream trace lines will be smoothed into simpler lines.
      -   <GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_LI_EA9150B251534B0AA4B1A362793B6F31 />
      -   <GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_5356A6DF_6F6A_41EF_9C2D_E71FE8CC7062 />
          -   `False`  : The lines will not be smoothed. The ungeneralized stream trace is more accurate but has more vertices, so the result is larger. This is the default.
          -   `True`  : The lines will be smoothed into simpler lines. The generalized stream trace looks best. It also has fewer vertices and, therefore, a smaller result file to transmit.
    </StyledTableCell>
  </StyledTableRow>
</StyledTable>

## Response

<GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_D4574F98_5D00_467C_BE89_524529F67768 />

<GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_7481CF75_D411_4A63_BA85_01E8F0C58F67 />

<GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_ED11CCC7_40D3_4ADD_A679_A3F6964834ED />

```
https://hydro.arcgis.com/arcgis/rest/services/Tools/Hydrology/GPServer/TraceDownstream/jobs/<jobId>
```

 

## Accessing results

<GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_03071520_C169_41C0_8E51_866D82061408 />

```
https://hydro.arcgis.com/arcgis/rest/services/Tools/Hydrology/GPServer/TraceDownstream/jobs/<jobId>/results/<output_parameter_name>?token=yourToken&f=json

```

<StyledTable headers={"Parameter,Description"}>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">
      `OutputTraceLine` 
      (Required)
    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">
      The Output Trace Line is the derived output.
      <GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_94883572_93CF_4FF7_B068_EFA064F5A2D0 />
    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">
    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">
    </StyledTableCell>
  </StyledTableRow>
</StyledTable>

## Javascript Example

<GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_F342A761_1C2C_49DB_8F5F_0978382ABA2B />

<GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_887B283C_08BE_4F01_BF45_8AC1F629C885 />

`dojo.require("esri.IdentityManager");`

 

<GUID_D5A128FE_89FD_4ECE_8925_14AF23433254_GUID_870D7B6F_ADE6_4B6A_BF5D_5F77154C9CD1 />

### Code sample

A live sample of this can be viewed with the following link: 

-   [View live sample](http://hydrology.esri.com/tracedownstream)

Following is the javascript used for the sample:

```html
<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=7, IE=9, IE=10">
    <!--The viewport meta tag is used to improve the presentation and behavior of the samples 
      on iOS devices-->
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>Trace Downstream</title>

    <link rel="stylesheet" href="http://js.arcgis.com/3.8/js/esri/css/esri.css">
    <link rel="stylesheet" href="http://js.arcgis.com/3.8/js/dojo/dijit/themes/claro/claro.css">

    <style>
      html, body, #mapDiv {
        height: 100%;
        margin: 0;
        padding: 0;
        width: 100%;
      }
      #info {
        bottom: 20px;
        color: #444;
        height: auto;
        font-family: arial;
        left: 20px;
        margin: 5px;
        padding: 10px;
        position: absolute;
        text-align: left;
        width: 200px;
        z-index: 40;
      }
    </style>

    <script src="http://js.arcgis.com/3.8/"></script>
    <script>
    require(["dojo/dom",
              "dojo/_base/Color",

              "esri/map",
              "esri/graphic",
              "esri/tasks/Geoprocessor",
              "esri/tasks/FeatureSet",
              "esri/layers/ArcGISTiledMapServiceLayer",
              "esri/symbols/SimpleMarkerSymbol",
              "esri/symbols/CartographicLineSymbol",
              "esri/IdentityManager"
              ],
        function(dom, Color, Map, Graphic, Geoprocessor, FeatureSet, ArcGISTiledMapServiceLayer, SimpleMarkerSymbol, CartographicLineSymbol){

          var map, gp;


    //Initialize Map
            map = new Map("mapDiv", {
              //basemap: "topo",
              center: [20.6, 0],
              zoom: 4
            });

            var basemap = new ArcGISTiledMapServiceLayer("http://server.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer");
            var overlay = new ArcGISTiledMapServiceLayer("http://hydrology.esri.com/arcgis/rest/services/WorldHydroReferenceOverlay/MapServer");
            map.addLayers([basemap, overlay])

    //Add Trace Downstream Geoprocessing Function
            gp = new Geoprocessor("http://hydro.arcgis.com/arcgis/rest/services/Tools/Hydrology/GPServer/TraceDownstream");
            gp.setOutputSpatialReference({wkid: 102100});
            map.on("click", Trace);

          function Trace(evt) {
            var pointSymbol = new SimpleMarkerSymbol();
            pointSymbol.setStyle(SimpleMarkerSymbol.STYLE_CROSS)
            /pointSymbol.setSize("13");
            var graphic = new Graphic(evt.mapPoint, pointSymbol);
            map.graphics.add(graphic);

            var features = [];
            features.push(graphic);
            var featureSet = new FeatureSet();
            featureSet.features = features;

            var params = {
              "InputPoints": featureSet,
              "DataSourceResolution": "FINEST",
              "Generalize": "True"
            };
            gp.submitJob(params, Callback, function(error){
            console.log("error", error, params);
            window.alert("Sorry, we do not have data for this region at your requested resolution");
            });
            }

          function Callback(jobInfo){
            gp.getResultData(jobInfo.jobId, "OutputTraceLine", drawTrace);
          }

          function drawTrace(results) {
            var traceLine = new CartographicLineSymbol(CartographicLineSymbol.STYLE_SOLID, new Color([0,0,255,1]), 5);
            traceLine.setCap(CartographicLineSymbol.CAP_ROUND);
            traceLine.setJoin(CartographicLineSymbol.JOIN_ROUND);

            console.log(results);
            var features = results.value.features;
            for (var f=0, fl=features.length; f<fl; f++) {
              var feature = features[f];
              feature.setSymbol(traceLine);
              map.graphics.add(feature);
            }
          }

    });
    </script>

  </head>
  <body class="claro">
    <div id="mapDiv"></div>
    <div id="info" class="esriSimpleSlider">
      Click on map to execute Trace Downstream. <br>
        <a href="http://www.arcgis.com/home/item.html?id=5314c23c24484c68ac961f8772be813b" target="Ref">More...</a>
    </div>
  </body>
</html>

```
