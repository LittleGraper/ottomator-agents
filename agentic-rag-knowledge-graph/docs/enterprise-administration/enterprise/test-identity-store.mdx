---
title: "Test Identity Store"
description: "The testIdentityStore operation can be used to test the connection to a user or role (group) store."
slug: "test-identity-store"
url: "/test-identity-store"
guid: "GUID-0DE8E57D-13D8-4E42-8A9C-9E06C28DC7A9"
migratedTopicMetadata:
  FTITLE: "Test Identity Store"
  FDESCRIPTION: ""
  FCHANGES: "New Product"
  FISHRELEASELABEL: ""
  FESRISOFTWARERELEASE: ""
  FESRITAGCLOUD: ""
  FESRIRECREATIONPROCEDURE: ""
  FESRIPRODUCTLIFECYCLE: "10.9-*"
  CREATED-ON: "29/09/2020 09:24:27"
  FAUTHOR: "tohara"
  FSTATUS: "Released"
  MODIFIED-ON: "17/11/2021 16:33:51"
  VERSION: "1"
  FRESOLUTION: ""
  DOC-LANGUAGE: "en"
  FISHREVCOUNTER: "14"
  ED: "GUID-A5B980A8-C8F9-4CEB-8FED-1B4D65BAF429"
  FUSERGROUP: "VUSERGROUPARCGISONLINEDOC"
  READ-ACCESS: ""
restInfoMetadata:
  apiPath: /security/config/testIdentityStore
  urlSegments:
    - name: <root>
      url: /enterprise-admin-root
    - name: /security/config/testIdentityStore
  methods:
    - post
  sslOnly: 'no'
  versionIntroduced: '10.9'
  requiredCapabilities:
    - name: Access allowed with the "Security and infrastructure" privilege
      url: /managing-access-to-the-enterprise-admin-api
---

## Description

The `testIdentityStore` operation can be used to test the connection to a user or role (group) store.


## Request parameters

<StyledTable headers={"Parameter,Details"}>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">

      `userStoreConfig` 

    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">

      Specifies the user store properties. This parameter accepts as input all the properties as defined in the [userStoreConfig and roleStoreConfig properties section below](/test-identity-store#userstoreconfig-and-rolestoreconfig-properties).

    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">

      `roleStoreConfig` 

    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">

      Specifies the role (group) store properties. This parameter accepts as input all the properties as defined in the [userStoreConfig and roleStoreConfig properties section below](/test-identity-store#userstoreconfig-and-rolestoreconfig-properties).

    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">

      `f` 

    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">

      The response format. The default format is `html`.

      Values: `html` | `json` | `pjson`

    </StyledTableCell>
  </StyledTableRow>
</StyledTable>


## userStoreConfig and roleStoreConfig properties

<StyledTable headers={"Parameter,Details"}>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">

      `userPassword` 

    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">

      The password for the domain account.

      ```markdown label=Example
      "userPassword": "secret"
      ```

    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">

      `isPasswordEncrypted` 

    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">

      Indicates whether the `userPassword` property is an encrypted password or plain text. If the property is `false`, the API will encrypt the password automatically.

      Values: `true` | `false`

    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">

      `user` 

    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">

      A user account with at least read permissions to look up the email addresses and usernames of users in your organization. If possible, use an account whose password does not expire.

      ```other label=Example
      //Windows Active Directory
      "user": "mydomain\\winaccount"

      //LDAP example
      "user": "uid-admin,ou=system"

      ```

    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">

      `userFulnameAttribute` 

    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">

      The attribute in Windows Active Directory or LDAP that contains the user's full name.

      ```markdown label=Example
      "userFullnameAttribute": "cn"
      ```

    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">

      `ldapURLForUsers` 

    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">

      The URL to your LDAP that points to the user accounts. The URL to your LDAP will need to be provided by your LDAP administrator. Although both LDAP and LDAPS URLs are supported, LDAPS is recommended to ensure encrypted network traffic between your deployment and the LDAP server. If LDAPS is not available, a LDAP URL can be used. However, traffic will be sent in clear text. This property is not applicable when configuring Windows Active Directory.

      ```other label=Example
      "ldapURLForUsers": "ldaps://bar2:10636/ou=users,ou=ags,dc=example,dc=com"
      ```

    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">

      `ldapURLForRoles` 

    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">

      The URL to your LDAP that points to the roles. The URL to your LDAP will need to be provided by your LDAP administrator. Although both LDAP and LDAPS URLs are supported, LDAPS is recommended to ensure encrypted network traffic between the portal and the LDAP server. If LDAPS is not available, a LDAP URL can be used. However, the traffic will be sent in clear text. This property is not applicable when configuring Windows Active Directory.

      ```other label=Example
      "ldapURLForRoles": "ldaps://bar2:10636/ou=roles,ou=ags,dc=example,dc=com"

      ```

    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">

      `userEmailAttribute` 

    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">

      The attribute in Windows Active Directory or LDAP that contains the email addresses of the users.

      ```markdown label=Example
      "userEmailAttribute": "mail"
      ```

    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">

      `usernameAttribute` 

    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">

      The LDAP attribute of the user entry that is to be treated as the username. This property is not applicable when configuring Windows Active Directory.

      ```markdown label=Example
      "usernameAttribute": "cn"
      ```

    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">

      `userSearchAttribute` 

    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">

      When using LDAP and PKI, you'll need to specify the value for `userSearchAttribute`. The `userSearchAttribute` is the value of the `Subject` parameter of the PKI certificate. If your organization uses another attribute in the PKI certificate, such as `email`, you must update the `userSearchAttribute` to match the `Subject` parameter in the PKI certificate.

    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">

      `caseSensitive` 

    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">

      If your Windows Active Directory is configured to be case sensitive, set this property to `true`. If your LDAP is configured to be case insensitive, set the parameter to `false`.

      Values: `true` | `false`

    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">

      `followReferrals` 

    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">

      This property controls whether LDAP referrals are followed when ArcGIS Enterprise on Kubernetes queries domain controllers for user or group information. By default, this is set to `true`.

      Values: `true` | `false`

    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">

      `domainControllerAddress` 

    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">

      A comma-separated list of one or more host names or IP addresses for the domain controllers to be used by ArcGIS Enterprise on Kubernetes. This property is required if the user or role (group) store `config` type is set to `WINDOWS`.

      <Note type={"note"}>

      ArcGIS Enterprise on Kubernetes always attempts to make a secure LDAPS connection to the domain controller. If the LDAP TLS certificate used by the domain controller is not trusted, or the domain name or IP address used to access it is not included as a subject alternative name in the certificate, the connection will fail and ArcGIS Enterprise on Kubernetes will attempt to use a regular LDAP connection.

      </Note>

    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">

      `domainControllerMapping` 

    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">

      The host name or IP address of one or more domain controllers for specific domains. In a multidomain environment, this is needed to link domain names to specific domain controllers. Multiple domains can be listed along with multiple host names or IP addresses for each domain. This property is required if the user or role (group) store `config` type is set to `WINDOWS`.

      <Note type={"note"}>

      ArcGIS Enterprise on Kubernetes always attempts to make a secure connection to the domain controller. The TLS certificate used by the domain controller must have the host name or IP address included as a subject alternative name in the certificate for proper certificate verification.

      </Note>

      ```markdown label=Syntax
      domain1.com=hostname1, hostname2; domain2.com=hostname3, hostname4
      ```

    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">

      `refreshUserMembershipDuringLoginEnabled` 

    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">

      This property is only applicable when configuring the role (group) store. By default, each time an enterprise user signs in to portal, the groups are refreshed automatically. If this behavior adversely affects login performance, it can be disabled by setting the value of this parameter to `false`. The default value is `true`.

      Values: `true` | `false`

    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">

      `membershiprefreshIntervalHours` 

    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">

      This property is only applicable when configuring the role (group) store. ArcGIS Enterprise on Kubernetes periodically refreshes all user memberships. This parameter determines the interval at which the refresh repeats. The default value is 24 (hours).

    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">

      `membershipRefreshStartTime` 

    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">

      This property is only applicable when configuring the role (group) store. This parameter determines the start time of the periodic fresh. The format is a 24-hour clock string. The default time is midnight ("00:00"). The refresh operation may be computationally expensive, so it is recommended that the refresh time not be during business hours when the portal may be busy.

    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">

      `checkForMultipleUsernameFormats` 

    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">

      This property is only applicable when configuring the user store with Windows Active Directory and using portal-tire authentication to sign in. By default, `checkForMultipleUsernameFormats` is `false`, and any enterprise users that sign in will need to use the following username formats: `DOMAIN\username` or `username@DOMAIN`. If `checkForMultipleUsernameFormats` is `true`, your portal will attempt to use different username formats if the initial attempt fails (includes `username` and `username@DOMAIN.com`).

      Values: `true` | `false`

    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">

      `userSSLOnly` 

    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">

      This property applies to Windows Active Directory only. It enforces encrypted communication between ArcGIS Enterprise on Kubernetes and Active Directory. When the property is set to `true`, if encrypted communication fails, the portal does not attempt to communicate without encryption. This property is set to `false` by default.

      Values: `true` | `false`

    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">

      `userGivenNameAttribute` 

    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">

      This property applies to both Windows Active Directory and LDAP. This property can be used to return the actual first name value stored in the windows Active Directory or LDAP identity store.

    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">

      `userSuernameAttribute` 

    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">

      This property applies to both Windows Active Directory and LDAP. This property can be used to return the actual last name value stored in the Windows Active Directory or LDAP identity store.

    </StyledTableCell>
  </StyledTableRow>
</StyledTable>


## Example usage

The following is a sample POST request for the `testIdentityStore` operation:

```other
POST /context/admin/security/config/testIdentityStore HTTP/1.1
Host: organization.domain.com
Content-Type: application/x-www-form-urlencoded
Content-Length: []

userStoreConfig={
  "type": "WINDOWS",
  "properties": {
    "userPassword": "secret",
    "isPasswordEncrypted": "false",
    "user": "mydomain\\winaccount",
    "userFullnameAttribute": "displayName",
    "userEmailAttribute": "mail",
    "userGivenNameAttribute": "givenName",
    "userSurnameAttribute": "sn",
    "caseSensitive": "false",
    "domainControllerAddress": "10.50.4.36, 10.48.4.1",
    "domainControllerMaping": "uc.esri.com=10.50.4.134, 10.50.4.133; esri.com=10.50.4.36, 10.48.4.1"
  }
}&roleStoreConfig={
  "type": "WINDOWS",
  "properties": {
    "isPasswordEncrypted": "true",
    "userPassword": "xxx",
    "user": "mydomain\\winaccount",
    "domainControllerAddress": "10.50.4.36, 10.48.4.1",
    "domainControllerMaping": "uc.esri.com=10.50.4.134, 10.50.4.133; esri.com=10.50.4.36, 10.48.4.1"
  }
}&f=pjson&token=Mb0ORrkLObNO2Q8FZoUCHHzSMzZi0CbhLHNRYMqqa6URG_ojQJF3rNsJAfRB23MyCrLwSmuaHPUo4AEIrUuoH1-4Ot5xh4565FtlQahXAhK2C7Sy0oydZhBwD8KdFSnVlnLr-e9uI5ovSWZ2lGNn9SwoV2MPMzeAh_5r-q-wgwF8DTT_nhuCXJGkMRy-48jjGS2aN5FI18STHZ8RAuKxGasH90SI3C7njZzlGCUrY5m6BDhCMsdpZA14GwNX8Cis

```

## JSON Response example

```other
{"status": "success"}
```