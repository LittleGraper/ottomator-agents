---
title: "Flow Direction"
description: "The FlowDirection task creates a raster of flow direction from each cell to its steepest downslope neighbor."
slug: "flow-direction"
url: "/flow-direction"
guid: "GUID-C19BEC02-C30B-4CF8-AC9E-C5ECB1D93627"
migratedTopicMetadata:
  FTITLE: "Flow Direction"
  FDESCRIPTION: ""
  FCHANGES: "Removing related resources re: https://devtopia.esri.com/WebGIS/arcgis-rest-api-documentation/issues/191"
  FISHRELEASELABEL: ""
  FESRISOFTWARERELEASE: ""
  FESRITAGCLOUD: ""
  FESRIRECREATIONPROCEDURE: ""
  FESRIPRODUCTLIFECYCLE: "10.7 - *"
  CREATED-ON: "13/09/2022 11:37:55"
  FAUTHOR: "tohara"
  FSTATUS: "Released"
  MODIFIED-ON: "20/09/2022 11:06:02"
  VERSION: "2"
  FRESOLUTION: ""
  DOC-LANGUAGE: "en"
  FISHREVCOUNTER: "3"
  ED: "GUID-E6C3E4B2-D495-4183-AED1-B7FF262565DC"
  FUSERGROUP: ""
  READ-ACCESS: ""
restInfoMetadata:
  apiPath: /<serviceName>/RasterAnalysisTools/GPServer/FlowDirection
  urlSegments:
    - name: <root>
      url: /catalog
    - name: /<serviceName>/RasterAnalysisTools/GPServer/FlowDirection
  methods: []
  sslOnly: 'no'
  versionIntroduced: '10.6'
---

import GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_GUID_9F3BEEEA_F576_4F40_9D31_AC860CE1EE01 from "./snippets/GUID-512E1710-163F-43F9-8ABC-FA35AE6DD5DF/_GUID-9F3BEEEA-F576-4F40-9D31-AC860CE1EE01";
import GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_GUID_59BC6D2B_4DDF_47B1_87EB_007154B11B73 from "./snippets/GUID-512E1710-163F-43F9-8ABC-FA35AE6DD5DF/_GUID-59BC6D2B-4DDF-47B1-87EB-007154B11B73";
import GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_GUID_F2432D7C_6B85_43BD_B98C_40AC9E9EBA22 from "./snippets/GUID-512E1710-163F-43F9-8ABC-FA35AE6DD5DF/_GUID-F2432D7C-6B85-43BD-B98C-40AC9E9EBA22";
import GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_GUID_8F14A47B_448F_4A97_9AF3_539B5A3C476E from "./snippets/GUID-512E1710-163F-43F9-8ABC-FA35AE6DD5DF/_GUID-8F14A47B-448F-4A97-9AF3-539B5A3C476E";
import GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_GUID_BC709D89_11A7_45CE_8A77_8E5D38A6698F from "./snippets/GUID-512E1710-163F-43F9-8ABC-FA35AE6DD5DF/_GUID-BC709D89-11A7-45CE-8A77-8E5D38A6698F";
import GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_GUID_53C636A8_E4F7_4DC6_9B19_2E63323CD9DC from "./snippets/GUID-512E1710-163F-43F9-8ABC-FA35AE6DD5DF/_GUID-53C636A8-E4F7-4DC6-9B19-2E63323CD9DC";
import GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_LI_D369F298433B41D99CAF9C6C488DBA13 from "./snippets/GUID-512E1710-163F-43F9-8ABC-FA35AE6DD5DF/_LI_D369F298433B41D99CAF9C6C488DBA13";
import GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_LI_8F18DD03A2D743938C83FD639D4972E7 from "./snippets/GUID-512E1710-163F-43F9-8ABC-FA35AE6DD5DF/_LI_8F18DD03A2D743938C83FD639D4972E7";
import GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_LI_20FA5DC3546F442F9404033BCE651ADF from "./snippets/GUID-512E1710-163F-43F9-8ABC-FA35AE6DD5DF/_LI_20FA5DC3546F442F9404033BCE651ADF";
import GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_GUID_E671F554_89D2_4CAD_B032_525E1CE90C18 from "./snippets/GUID-512E1710-163F-43F9-8ABC-FA35AE6DD5DF/_GUID-E671F554-89D2-4CAD-B032-525E1CE90C18";
import GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_LI_1744B5CA044F44D8ABF2E27EF9BC9A27 from "./snippets/GUID-512E1710-163F-43F9-8ABC-FA35AE6DD5DF/_LI_1744B5CA044F44D8ABF2E27EF9BC9A27";
import GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_LI_AD9814DB26DA439EA899971516D5E44D from "./snippets/GUID-512E1710-163F-43F9-8ABC-FA35AE6DD5DF/_LI_AD9814DB26DA439EA899971516D5E44D";
import GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_LI_7566284934CF4B3BAFE1FBAA218408CB from "./snippets/GUID-512E1710-163F-43F9-8ABC-FA35AE6DD5DF/_LI_7566284934CF4B3BAFE1FBAA218408CB";
import GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_LI_2DDA48A24C404781BB03BF05B81B3C19 from "./snippets/GUID-512E1710-163F-43F9-8ABC-FA35AE6DD5DF/_LI_2DDA48A24C404781BB03BF05B81B3C19";
import GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_LI_E5BF6567427444E8B74C6B8212C56B99 from "./snippets/GUID-512E1710-163F-43F9-8ABC-FA35AE6DD5DF/_LI_E5BF6567427444E8B74C6B8212C56B99";
import GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_GUID_9B5D5783_E386_45F7_8EA8_88843A1BB484 from "./snippets/GUID-512E1710-163F-43F9-8ABC-FA35AE6DD5DF/_GUID-9B5D5783-E386-45F7-8EA8-88843A1BB484";
import GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_GUID_C771449E_6BA7_4CB4_9328_2C855A14B2B2 from "./snippets/GUID-512E1710-163F-43F9-8ABC-FA35AE6DD5DF/_GUID-C771449E-6BA7-4CB4-9328-2C855A14B2B2";
import GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_GUID_1702083F_151C_4A0C_AF36_0D0DD9E2563A from "./snippets/GUID-512E1710-163F-43F9-8ABC-FA35AE6DD5DF/_GUID-1702083F-151C-4A0C-AF36-0D0DD9E2563A";
import GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_GUID_4B398B66_01FD_40FB_9AEE_30371F0A8CD8 from "./snippets/GUID-512E1710-163F-43F9-8ABC-FA35AE6DD5DF/_GUID-4B398B66-01FD-40FB-9AEE-30371F0A8CD8";
import GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_GUID_ED11CCC7_40D3_4ADD_A679_A3F6964834ED from "./snippets/GUID-512E1710-163F-43F9-8ABC-FA35AE6DD5DF/_GUID-ED11CCC7-40D3-4ADD-A679-A3F6964834ED";
import GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_GUID_50D345C8_14F8_4A4A_AB1E_A6BBD19C49EF from "./snippets/GUID-512E1710-163F-43F9-8ABC-FA35AE6DD5DF/_GUID-50D345C8-14F8-4A4A-AB1E-A6BBD19C49EF";

## Description

![Flow Direction task](./images/GUID-3315242E-06F3-4F78-B9AA-0DF59F63EA31-web.png)

<GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_GUID_9F3BEEEA_F576_4F40_9D31_AC860CE1EE01 />

This task supports three flow modeling algorithms. Those are D8, Multi Flow Direction (MFD), and D-Infinity (DINF).

### D8 flow modeling algorithm

The D8 flow method models flow direction from each cell to its steepest downslope neighbor.

The output of the `FlowDirection` task run with the D8 flow direction type is an integer raster whose values range from 1-255. The values for each direction from the center are the following:

![Flow Direction codes](./images/GUID-DC135A95-CADF-468F-BF6E-E94BB724EB17-web.gif)

For example, if the direction of steepest drop was to the left of the current processing cell, its flow direction would be coded at 16.

The following are additional considerations for using the D8 flow method:

-   If a cell is lower than its eight neighbors, that cell is given the value of its lowest neighbor, and flow is defined toward this cell. If multiple neighbors have the lowest value, the cell is still given this value, but flow is defined with one of the two methods explained below. This is used to filter out one-cell sinks, which are considered noise.
-   If a cell has the same change in z-value in multiple directions and that cell is part of a sink, the flow direction is referred to as undefined. In such cases, the value for that cell in the output flow direction raster will be the sum of those directions. For example, if the change in z-value is the same both to the right (flow direction = 1) and down (flow direction = 4), the flow direction for that cell is 5.
-   If a cell has the same change in z-value in multiple directions and is not part of a sink, the flow directions is assigned with a lookup table defining the most likely direction. See Greenlee (1987).
-   The output drop raster is calculated as the difference in z-value divided by the path length between the cell centers, expressed in percentages. For adjacent cells, this is analogous to the percent slop between cells. Across a flat area, the distance becomes the distance to the nearest cell of lower elevation. The result is a map of percent rise in the path of steepest descent from each cell.
-   When calculating a drop raster in flat areas, the distance to diagonally adjacent cells (`1.41421 * cell size`) is approximated by `1.5 * cell size` for improved performance.
-   With the `forceFlow` parameter set to the default value `False`, a cell at the edge of the surface raster will flow towards the inner cell with the steepest z-value. If the drop is less than or equal to zero, the cell will flow out of the surface raster.

### MFD flow modeling algorithm

The MFD algorithm, described by Qin et al. (2007), partitions flow from a cell to all downslope neighbors. A flow-partition exponent is created from an adaptive approach based on local terrain conditions and is used to determine fraction of flow draining to all downslope neighbors.

When the MFD flow direction output is added to a map, it only displays the D8 flow direction. As MFD flow directions have potentially multiple values tied to each cell (each value corresponds to proportion of flow to each downslope neighbor), it is not easily visualized. However, an MFD flow direction output raster is an input recognized by the `FlowAccumulation`  task that would utilize the MFD flow directions to proportion and accumulate flow from each cell to all downslope neighbors.

### DINF flow modeling algorithm

The DINF flow method, described by Tarboton (1997), determines flow direction as the steepest downward slope on eight triangular facets formed in a 3x3 cell window centered on the cell of interest. The flow direction output is a floating-point raster represented as a single angle in degrees going counter-clockwise from 0 (due east) to 360 (also due east).

## Request parameters

<StyledTable headers={"Parameter,Details"}>
    <StyledTableRow>
        <StyledTableCell cellStyle="markdown">
            `inputSurfaceRaster` 
            (Required)
        </StyledTableCell>
        <StyledTableCell cellStyle="markdown">
            The input raster representing a continuous surface.
            <GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_GUID_59BC6D2B_4DDF_47B1_87EB_007154B11B73 />
            Examples:
            ```javascript
            //Portal item as input raster
            "inputSurfaceRaster": {"itemId": <portal item id>}

            //URL as input raster
            "inputSurfaceRaster": {"url": <image service layer url>}
            ```
        </StyledTableCell>
    </StyledTableRow>
    <StyledTableRow>
        <StyledTableCell cellStyle="markdown">
            `outputFlowDirectionName` 
            (Required)
        </StyledTableCell>
        <StyledTableCell cellStyle="markdown">
            The output flow direction image service name that will be created.
            <GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_GUID_F2432D7C_6B85_43BD_B98C_40AC9E9EBA22 />
            <GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_GUID_8F14A47B_448F_4A97_9AF3_539B5A3C476E />
            Output name example:
            ```javascript
            "outputFlowDirectionName":{"serviceProperties":{"name":"testrasteranalysis"}}
            ```
            Output raster examples:
            ```javascript
            //Output portal item:
            "outputFlowDirectionName":{"itemId": <portal item id>}

            //Output url:
            "outputFlowDirectionName":{"url": <image service url>}

            //Output raster layer service:
            "outputFlowDirectionName":{"service properties":
              {"name":"testrasteranalysis",
              "serviceUrl":"https://<server name>/server/rest/services/Hosted/testrasteranalysis/ImageServer",
              "itemProperties":{"itemId":"8cfbd3ec25584d0d8f4ed23b8ff7c43b","folderId":"sdfwerfbd3ec25584d0d8f4"}}
            }
            ```
        </StyledTableCell>
    </StyledTableRow>
    <StyledTableRow>
        <StyledTableCell cellStyle="markdown">
            `forceFlow` 
            (Optional)
        </StyledTableCell>
        <StyledTableCell cellStyle="markdown">
            Specifies if edge cells will always flow outward or follow normal flow rules.
            <GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_GUID_BC709D89_11A7_45CE_8A77_8E5D38A6698F />
            -   `False`  specifies that, if the maximum drop on the inside of an edge cell is greater than zero, the flow direction will be determined as ususal. Otherwise, the flow direction will be toward the edge. Cells that should flow from the edge of the surface to the raster inward will do so. This is the default.
            -   `True`  specifies that all cells as the edge of the surface raster will flow outward from the surface raster.
        </StyledTableCell>
    </StyledTableRow>
    <StyledTableRow>
        <StyledTableCell cellStyle="markdown">
            `flowDirectionType` 
            (Optional)
        </StyledTableCell>
        <StyledTableCell cellStyle="markdown">
            Specifies the flow direction type to use.
            <GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_GUID_53C636A8_E4F7_4DC6_9B19_2E63323CD9DC />
            -   <GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_LI_D369F298433B41D99CAF9C6C488DBA13 />
            -   <GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_LI_8F18DD03A2D743938C83FD639D4972E7 />
            -   <GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_LI_20FA5DC3546F442F9404033BCE651ADF />
        </StyledTableCell>
    </StyledTableRow>
    <StyledTableRow>
        <StyledTableCell cellStyle="markdown">
            `outputDropName` 
            (Optional)
        </StyledTableCell>
        <StyledTableCell cellStyle="markdown">
            The optional output name drop image service name.

            The drop raster returns the ratio of the maximum change in elevation from each cell along the direction of flow to the path length between centers of cells, expressed in percentages.
            <GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_GUID_F2432D7C_6B85_43BD_B98C_40AC9E9EBA22 />
            Syntax: A JSON object describes the name of the output or the output drop raster.
            Output name example:
            ```javascript
            "outputDropName":{"serviceProperties":{"name":"testagl"}}
            ```
            Output raster examples:
            ```javascript
            //Output portal item
            "outputDropName":{"itemId": <portal item Id>}
            //Output url
            "outputDropName":{"url": <image service url>}
            //Output raster layer service
            "outputDropName":{"serviceProperties":
              {"name":"testagl",
              "serviceUrl":"https://<server name>/server/rest/services/Hosted/testrasteranalysis/ImageServer", 
              "itemProperties":{"itemId":"8cfbd3ec25584d0d8f4ed23v8ff7c43b","folderId":"sdfwerfbd3ec25584d0d8f4"}}
            }
            ```
        </StyledTableCell>
    </StyledTableRow>
    <StyledTableRow>
        <StyledTableCell cellStyle="markdown">
            `context` 
            (Optional)
        </StyledTableCell>
        <StyledTableCell cellStyle="markdown">
            <GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_GUID_E671F554_89D2_4CAD_B032_525E1CE90C18 />
            -   <GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_LI_1744B5CA044F44D8ABF2E27EF9BC9A27 />
            -   <GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_LI_AD9814DB26DA439EA899971516D5E44D />
            -   <GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_LI_7566284934CF4B3BAFE1FBAA218408CB />
            -   <GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_LI_2DDA48A24C404781BB03BF05B81B3C19 />
            -   <GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_LI_E5BF6567427444E8B74C6B8212C56B99 />
        </StyledTableCell>
    </StyledTableRow>
    <StyledTableRow>
        <StyledTableCell cellStyle="markdown">
            `f` 
        </StyledTableCell>
        <StyledTableCell cellStyle="markdown">
            <GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_GUID_9B5D5783_E386_45F7_8EA8_88843A1BB484 />
            <GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_GUID_C771449E_6BA7_4CB4_9328_2C855A14B2B2 />
        </StyledTableCell>
    </StyledTableRow>
</StyledTable>

## Response

<GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_GUID_1702083F_151C_4A0C_AF36_0D0DD9E2563A />

<GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_GUID_4B398B66_01FD_40FB_9AEE_30371F0A8CD8 />

<GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_GUID_ED11CCC7_40D3_4ADD_A679_A3F6964834ED />

```javascript
https://<raster analysis tools url>/FlowDirection/jobs/<jobId>
```

<GUID_512E1710_163F_43F9_8ABC_FA35AE6DD5DF_GUID_50D345C8_14F8_4A4A_AB1E_A6BBD19C49EF />

```javascript
https://<raster analysis tools url>/FlowDirection/jobs/<jobId>/results/<output parameter>
```
 

## Example usage

Below is a sample request URL for `FlowDirection` .

```javascript
https://services.myserver.com/arcgis/rest/services/System/RasterAnalysisTools/GPServer/FlowDirection/submitJob
```

 
## JSON Response example

The response returns the `outputFlowDirectionRaster`  and `outputDropRaster`  output parameters, which have properties for parameter name, data type, and value. The content of value is always the output raster dataset `itemId`  and the image service URL.

```javascript
{
  "paramName": "outputFlowDirectionRaster",
  "dataType": "GPString",
  "value": {
    "itemId": "f121390b85ef419790479fc75b493efd",
    "url": "https://<server name>/arcgis/rest/services/Hosted/<service name>/ImageServer"
  }
}
```

 

## References

Greenlee, D. D. 1987. "Raster and Vector Processing for Scanned Linework." _Photogrammetric Engineering and Remote Sensing_ 53(10): 1383-1387.

Tarboton, D. G. 1997. "A new method for the determination of flow directions and upslope areas in grid digital elevation models." _Water Resources Research_ 33(2): 309-319.

Qin, C., Zhu, A. X., Pei, T., Li, B., Zhou, C., & Yang, L. 2007. "An adaptive approach to selecting a flow partition exponent for a multiple flow direction algorithm." _International Journal of Geographical Information Science_ 21(4): 443-458.
