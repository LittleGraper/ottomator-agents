---
title: "Aggregate Points"
description: "API reference for the Aggregate Points task available through the ArcGIS GeoAnalytics Server service."
slug: "aggregate-points"
url: "/geoanalytics/tasks/aggregate-points"
redirectFrom:
  - /aggregate-points/
guid: "GUID-3D3C723B-56C6-409C-A4FE-B86B773A7B6F"
migratedTopicMetadata:
  FTITLE: "Aggregate Points"
  FDESCRIPTION: "Template conversion"
  FCHANGES: ""
  FISHRELEASELABEL: ""
  FESRISOFTWARERELEASE: ""
  FESRITAGCLOUD: ""
  FESRIRECREATIONPROCEDURE: ""
  FESRIPRODUCTLIFECYCLE: "11.2 - *"
  CREATED-ON: "16/08/2023 19:13:09"
  FAUTHOR: "nslocum"
  FSTATUS: "Released"
  MODIFIED-ON: "04/10/2023 11:44:42"
  VERSION: "2"
  FRESOLUTION: ""
  DOC-LANGUAGE: "en"
  FISHREVCOUNTER: "4"
  ED: "GUID-33BEAFC0-3148-4C26-8107-F64D0183AA5A"
  FUSERGROUP: "VUSERGROUPARCGISONLINEDOC"
  READ-ACCESS: ""
restInfoMetadata:
  apiPath: /AggregatePoints
  urlSegments:
    - name: <geoanalytics-url>
      url: /geoanalytics-tasks
    - name: /AggregatePoints
  methods: []
  sslOnly: 'no'
  versionIntroduced: '10.5'
---

import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_DC085569_B522_4EE0_B0B5_2F7A608B8064 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-DC085569-B522-4EE0-B0B5-2F7A608B8064";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_8280F941_0439_4805_B034_1E224F28280C from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-8280F941-0439-4805-B034-1E224F28280C";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_A6FED648_EF3E_4164_8718_D12E25E834F0 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-A6FED648-EF3E-4164-8718-D12E25E834F0";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_22C271BC_367D_4DB7_A325_85FDF16AE790 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-22C271BC-367D-4DB7-A325-85FDF16AE790";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_DCBBCD5F_96A0_45B7_94A9_BEA8897EA77E from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-DCBBCD5F-96A0-45B7-94A9-BEA8897EA77E";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_BC6FE36E_EB24_4EE8_B1FD_8A72FDF57AD4 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-BC6FE36E-EB24-4EE8-B1FD-8A72FDF57AD4";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_D6DCDDB8_9F57_44CC_9B81_08958F087009 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-D6DCDDB8-9F57-44CC-9B81-08958F087009";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_3AB5CC42_F85F_4047_A88D_2B0712B8435E from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-3AB5CC42-F85F-4047-A88D-2B0712B8435E";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_B66A5391_775F_4E9A_B717_F84D52A10572 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-B66A5391-775F-4E9A-B717-F84D52A10572";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_E671F554_89D2_4CAD_B032_525E1CE90C18 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-E671F554-89D2-4CAD-B032-525E1CE90C18";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_9BD8524A_A4D0_4128_876A_6CA8568233A7 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-9BD8524A-A4D0-4128-876A-6CA8568233A7";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_9B5D5783_E386_45F7_8EA8_88843A1BB484 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-9B5D5783-E386-45F7-8EA8-88843A1BB484";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_C771449E_6BA7_4CB4_9328_2C855A14B2B2 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-C771449E-6BA7-4CB4-9328-2C855A14B2B2";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_9562E716_BEF8_4A70_A787_C7231BB32C3E from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-9562E716-BEF8-4A70-A787-C7231BB32C3E";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_CBCE73F1_60C0_4D53_BDE3_B2C3ACEBD24A from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-CBCE73F1-60C0-4D53-BDE3-B2C3ACEBD24A";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_EE2D677C_9158_4D61_A164_2444C6476C92 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-EE2D677C-9158-4D61-A164-2444C6476C92";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_03071520_C169_41C0_8E51_866D82061408 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-03071520-C169-41C0-8E51-866D82061408";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_A0501D59_23F2_456F_AAFF_3BCC593D9E34 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-A0501D59-23F2-456F-AAFF-3BCC593D9E34";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_A771740E_17FA_47C6_A2FC_6BF0B76090CA from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-A771740E-17FA-47C6-A2FC-6BF0B76090CA";
import GAX_DEPRECATION_NOTICE from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_gax-general-deprecation-notice.mdx";

## Description

<GAX_DEPRECATION_NOTICE />

![AggregatePoints](../../images/GUID-778B20BE-A62E-4858-980D-EF9F530795B6-web.png)

The `AggregatePoints` operation works with a layer of point features and a layer of areas. The layer of areas can be an
input polygon layer or it can be square, hexagonal, or H3 bins calculated when the task is run. The tool first determines
which points fall within each specified area. After determining this point-in-area spatial relationship, statistics about
all points in the area are calculated and assigned to the area. The most basic statistic is the count of the number of
points within the area, but you can get other statistics as well.

For example, suppose you have point features of coffee shop locations and area features of countries, and you want to
summarize coffee sales by county. Assuming the coffee shops have a `TOTAL_SALES` attribute, you can get the sum of all
`TOTAL_SALES` within each county, the minimum or maximum `TOTAL_SALES` within each county, or other statistics like the
count, range, standard deviation, and variance.

This tool can also work on data that is time-enabled. If time is enabled on the input points, then the time stepping
options are available. Time stepping allows you to calculate the point-in area relationship while looking at a specific
step in time. For example, you could look at hourly intervals, which would result in outputs for each hour.

For an example with time, suppose you had point features of every transaction made at a coffee shop location and no
area layer. The data has been recorded over a year, and each transaction has a location and a time stamp. Assuming each
transaction has a `TOTAL_SALES` attribute, you can get the sum of all `TOTAL_SALES` within the space and time of
interest. If these transactions are for a single city, we could generate areas that are one kilometer grids, and look at
weekly time slices to summarize the transactions in both time and space.

##  Request parameters 

<StyledTable headers={"Parameter,Details"}>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `pointLayer`
         (Required)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         The point features that will be aggregated into the polygons in the `polygonLayer` or bins of the specified `binSize`.
         <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_DC085569_B522_4EE0_B0B5_2F7A608B8064 />
         REST examples
         ```javascript
         //REST web example
         {"url": "https://myportal.domain.com/server/rest/services/Hosted/hurricaneTrack/FeatureServer/0", "filter": "Month = 'September'"}
         //REST scripting example
         "pointLayer" : {"url": "https://myportal.domain.com/server/rest/services/Hosted/hurricaneTrack/FeatureServer/0", "filter": "Month = 'September'"}
         ```
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `binType`
         (Optional)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         The type of bin that will be generated and into which points will be aggregated. When generating bins for `Square`, the number and units specified determine the height and length of the square. For `Hexagon`, the number and units specified determine the distance between parallel sides. Analysis using `Square` or `Hexagon` bins requires a projected coordinate system. If a projected coordinate system is not specified when running analysis, a projection will be picked based on the extent of the data. Analysis using `H3` bins is supported at 11.2 or later and requires World Geodetic System 1984 (WKID 4326). If a different coordinate system is specified when running analysis with H3 bins, the input points will automatically be transformed into World Geodetic System 1984.

         Values: `H3` \| `Hexagon` \| `Square` (default)

         <Note type={"note"}>
            Either `binType` or `polygonLayer` must be specified. If `binType` is chosen, `binSize` and `binSizeUnit` must be included. If `binType` is `H3`, `binResolution` can be used instead of `binSize` and `binSizeUnit`.
         </Note>

         REST examples
         ```javascript
         //REST web example
         Hexagon
         //REST scripting example
         "binType": "Hexagon"
         ```
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `binSize`
         (Required if `binType` is used and `binResolution` is not used)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         The distance for the bins of type `binType` that the `pointLayer` will be aggregated into. When generating bins for `Square` the number and units specified determine the height and length of the square. For `Hexagon`, the number and units specified determine the distance between parallel sides. For `H3`, an H3 resolution will be chosen that produces bins with a distance between parallel sides closest to the number and units specified.

         REST examples
         ```javascript
         //REST web example
         108.3
         //REST scripting example
         "binSize": 100
         ```
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `binSizeUnit`
         (Required if `binSize` is used)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         The distance unit for the bins that the `pointLayer` will be aggregated into.
         <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_8280F941_0439_4805_B034_1E224F28280C />
         REST examples
         ```javascript
         //REST web example
         Meters
         //REST scripting example
         "binSizeUnit": "Miles"
         ```
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `binResolution`
         (Required if `binType` is `H3` and `binSize` is not used)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         This parameter is available at ArcGIS GeoAnalytics Server 11.2 or later.
         The resolution of H3 bins that the `pointLayer` will be aggregated into. This value is only used when `binType` is `H3` and `binSize` is not specified. Choose a resolution between 0 and 15, where 0 produces the largest bins and 15 produces the smallest bins.

         REST examples
         ```javascript
         //REST web example
         6
         //REST scripting example
         "binResolution": 6
         ```
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `polygonLayer`
         (Required if `binType` is not used)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         The polygon features (areas) into which the input points will be aggregated. This operation is not required if `binSize` and `binSizeUnit` have been defined.
         <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_DC085569_B522_4EE0_B0B5_2F7A608B8064 />
         REST examples
         ```javascript
         //REST web example
         {"url": "https://myportal.domain.com/server/rest/services/Hosted/hurricaneTrack/FeatureServer/0", "filter": "Month = 'September'"}
         //REST scripting example
         "pointLayer": {"url": "https://myportal.domain.com/server/rest/services/Hosted/hurricaneTrack/FeatureServer/0", "filter": "Month = 'September'"}
         ```
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `timeStepInterval`
         (Optional)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_A6FED648_EF3E_4164_8718_D12E25E834F0 />
         REST examples
         ```javascript
         //REST web example
         20
         //REST scripting example
         "timeStepInterval": 20
         ```
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `timeStepIntervalUnit`
         (Optional)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_22C271BC_367D_4DB7_A325_85FDF16AE790 />
         REST examples
         ```javascript
         //REST web example
         Minutes
         //REST scripting example
         "timeStepIntervalUnit": "Minutes"
         ```
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `timeStepRepeatInterval`
         (Optional)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_DCBBCD5F_96A0_45B7_94A9_BEA8897EA77E />
         REST examples
         ```javascript
         //REST web example
         1
         //REST scripting example
         "timeStepRepeatInterval": 1
         ```
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `timeStepRepeatIntervalUnit`
         (Optional)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_BC6FE36E_EB24_4EE8_B1FD_8A72FDF57AD4 />
         REST examples
         ```javascript
         //REST web example
         Hours
         //REST scripting example
         "timeStepRepeatIntervalUnit": "Hours"
         ```
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `timeStepReference`
         (Optional)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_D6DCDDB8_9F57_44CC_9B81_08958F087009 />
         REST examples
         ```javascript
         //REST web example
         946684800000
         //REST scripting example
         "timeStepReference": 946684800000
         ```
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `summaryFields`
         (Optional)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_3AB5CC42_F85F_4047_A88D_2B0712B8435E />
         Note that the `count` of points within each polygon is always returned.
         `onStatisticField` specifies the name of the fields in the target layer. `statisticType` is one of the following for numeric fields:
         -   `Count`— For numeric fields, this totals the number of values of all the points in each polygon. For string fields, this totals the number of strings for all the points in each polygon.
         -   `Sum`— Adds the total value of all the points in each polygon. For numeric fields.
         -   `Mean`— Calculates the average of all the points in each polygon. For numeric fields.
         -   `Max`— Calculates the largest value of all the points in each polygon. For numeric fields.
         -   `Range`— Finds the difference between the `Min` and `Max` values. For numeric fields.
         -   `Stddev`— Finds the standard deviation of all the points in each polygon. For numeric fields.
         -   `Var`— Finds the variance of all the points in each polygon. For numeric fields.
         -   `Any`— Returns a sample string of a point in each polygon. For string fields.

         REST examples
         ```javascript
         //REST web example
         [{"statisticType": "Mean", "onStatisticField": "Annual_Sales"},{"statisticType": "Sum", "onStatisticField": "Annual_Sales"}]
         //REST scripting example
         "summaryFields": ["statisticType": "Mean", "onStatisticField": "Annual_Sales"},{"statisticType": "Sum", "onStatisticField": "Annual_Sales"}]
         //Only return Count
         "summaryFields": []
         ```
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `outputName`
         (Required)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_B66A5391_775F_4E9A_B717_F84D52A10572 />
         REST examples
         ```javascript
         //REST web example
         myOutput
         //REST scripting example
         "outputName": "myOutput"
         ```
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `context`
         (Optional)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_E671F554_89D2_4CAD_B032_525E1CE90C18 />
         <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_9BD8524A_A4D0_4128_876A_6CA8568233A7 />
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `f`
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_9B5D5783_E386_45F7_8EA8_88843A1BB484 />
         <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_C771449E_6BA7_4CB4_9328_2C855A14B2B2 />
      </StyledTableCell>
   </StyledTableRow>
</StyledTable>


## Example usage

Below is a sample request URL for `AggregatePoints`: 

```javascript
https://webadaptor.domain.com/server/rest/services/System/GeoAnalyticsTools/GPServer/AggregatePoints/submitJob?pointLayer={"url":"https://webadaptor.domain.com/server/rest/services/Hurricane/hurricaneTrack/0"}&binType=Square&binSize=100&binSizeUnit=Meters&polygonLayer={}&timeStepInterval=20&timeStepIntervalUnit=Minutes&timeStepRepeatInterval=1&timeStepRepeatIntervalUnit=Days&timeStepReference=946684800000&summaryFields=[{"statisticType": "Mean","onStatisticField":"Annual_Sales"},{"statisticType":"Sum","onStatisticField":"Annual_Sales"}]&outputName=myOutput&context={"extent":{"xmin":-122.68,"ymin":45.53,"xmax":-122.45,"ymax":45.6,"spatialReference":{"wkid":4326}}&f=json
```

## Response

<GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_9562E716_BEF8_4A70_A787_C7231BB32C3E />

<GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_CBCE73F1_60C0_4D53_BDE3_B2C3ACEBD24A />

<GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_EE2D677C_9158_4D61_A164_2444C6476C92 />

### Accessing results

<GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_03071520_C169_41C0_8E51_866D82061408 />

```other
https://<analysis-url>/AggregatePoints/jobs/<jobId>/results/output?token=<your token>&f=json
```


<StyledTable headers={"Response,Description"}>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `output`
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         `output` will always contain polygon features. The number of resulting polygons is based on the location of `inputPoints`. The layer will inherit all the attributes of the input polygon layer; will have a `Count` attribute, which is the number of points that are enclosed by the polygon; and by default, will calculate all statistics for each field in the `pointsLayer`.
         If a `summaryFields` parameter is specified in the task request, the layer will compute the anything specified in the `summaryFields`. For example, if you had requested:
         ```javascript
         "summaryFields" :[{"statisticType": "Mean", "fieldName": "Annual_Sales"]
         ```
         the resulting polygon features would have two attributes, `Count` and `mean_Annual_Sales`, to contain the calculated values.
         ```javascript
         {"url": "https://<analysis-url>/AggregatePoints/jobs/<jobId>/results/output"}
         ```
         <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_A0501D59_23F2_456F_AAFF_3BCC593D9E34 />
         <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_A771740E_17FA_47C6_A2FC_6BF0B76090CA />
      </StyledTableCell>
   </StyledTableRow>
</StyledTable>