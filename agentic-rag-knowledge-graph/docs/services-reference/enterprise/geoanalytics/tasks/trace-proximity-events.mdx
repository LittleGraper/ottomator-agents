---
title: "Trace Proximity Events"
description: "API reference for the Trace Proximity Events task available in the ArcGIS GeoAnalytics Server service."
slug: "trace-proximity-events"
url: "/geoanalytics/tasks/trace-proximity-events"
redirectFrom:
  - /trace-proximity-events/
guid: "GUID-F57E9424-CADA-47A3-A421-EFA47B2385FE"
migratedTopicMetadata:
  FTITLE: "Trace Proximity Events"
  FDESCRIPTION: ""
  FCHANGES: ""
  FISHRELEASELABEL: ""
  FESRISOFTWARERELEASE: ""
  FESRITAGCLOUD: ""
  FESRIRECREATIONPROCEDURE: ""
  FESRIPRODUCTLIFECYCLE: "10.9 - *"
  CREATED-ON: "05/01/2021 14:53:10"
  FAUTHOR: "nslocum"
  FSTATUS: "Released"
  MODIFIED-ON: "03/02/2021 10:25:19"
  VERSION: "1"
  FRESOLUTION: ""
  DOC-LANGUAGE: "en"
  FISHREVCOUNTER: "8"
  ED: "GUID-0EF7137E-FC35-4D5D-9116-8322EB836448"
  FUSERGROUP: "VUSERGROUPARCGISONLINEDOC"
  READ-ACCESS: ""
restInfoMetadata:
  apiPath: /TraceProximityEvents
  urlSegments:
    - name: <geoanalytics-url>
      url: /geoanalytics-tasks
    - name: /TraceProximityEvents
  methods: []
  sslOnly: 'no'
  versionIntroduced: '10.9'
---

import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_DC085569_B522_4EE0_B0B5_2F7A608B8064 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-DC085569-B522-4EE0-B0B5-2F7A608B8064";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_8280F941_0439_4805_B034_1E224F28280C from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-8280F941-0439-4805-B034-1E224F28280C";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_A7CEF6BC_29BB_4AF8_9B53_DC19BA1D336E from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-A7CEF6BC-29BB-4AF8-9B53-DC19BA1D336E";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_4CB6D607_FF60_4C68_AFA1_8780CFFA421D from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-4CB6D607-FF60-4C68-AFA1-8780CFFA421D";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_E671F554_89D2_4CAD_B032_525E1CE90C18 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-E671F554-89D2-4CAD-B032-525E1CE90C18";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_9BD8524A_A4D0_4128_876A_6CA8568233A7 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-9BD8524A-A4D0-4128-876A-6CA8568233A7";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_9B5D5783_E386_45F7_8EA8_88843A1BB484 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-9B5D5783-E386-45F7-8EA8-88843A1BB484";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_C771449E_6BA7_4CB4_9328_2C855A14B2B2 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-C771449E-6BA7-4CB4-9328-2C855A14B2B2";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_EE2D677C_9158_4D61_A164_2444C6476C92 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-EE2D677C-9158-4D61-A164-2444C6476C92";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_03071520_C169_41C0_8E51_866D82061408 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-03071520-C169-41C0-8E51-866D82061408";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_9562E716_BEF8_4A70_A787_C7231BB32C3E from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-9562E716-BEF8-4A70-A787-C7231BB32C3E";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_CBCE73F1_60C0_4D53_BDE3_B2C3ACEBD24A from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-CBCE73F1-60C0-4D53-BDE3-B2C3ACEBD24A";
import GAX_DEPRECATION_NOTICE from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_gax-general-deprecation-notice.mdx";

## Description

<GAX_DEPRECATION_NOTICE />

![](../../images/GUID-AC2D23EE-B2DD-4FAF-967B-6E5C781F614B-web.png)

The Trace Proximity Events task analyzes time-enabled point features representing moving entities. The task will follow
entities of interest in space (location) and time to see which other entities the entities of interest have interacted
with. The trace will continue from entity to entity to a configurable maximum degrees of separation from the original
entity of interest.

For example, suppose an organization monitors company-issued devices carried by workers. The company is interested in
determining which employees were near an individual known to have COVID-19. Using the point layer representing device
locations and time, they can identify devices that have been within 6 meters and 5 minutes of the contagious person and
other possibly contagious employees.

As another example, an NGO is monitoring salmon populations using GPS and is interested in tracking the spread of
salmon lice between escaped farmed salmon and wild populations. Some GPS-tagged farmed salmon were tracked to see if
they come in close proximity with tagged wild populations, and how those wild populations may further spread the
disease. The measurements also include a depth field, and the NGO uses the `attributeMatchCriteria` parameter to only
find fish at a similar depth.

The Trace Proximity Events task uses the following terminology:

<StyledTable headers={"Term,Definition,Example"}>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         Entity
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         A moving object with position periodically recorded.
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         An animal, person, or vehicle. An entity may be stationary or moving.
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         Entities of interest
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         The specific entities used to start a trace.
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         A person infected with COVID-19.
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         Proximity event
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         When two entities are near each other within a period of time.
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         Two people that come within 3 meters of each other and within a 1-minute window of each other.
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         Depth
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         The degree of separation between an entity of interest and an entity further down the trace (downstream).
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         A proximity event between the entity of interest and someone else is depth 1.
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         Trace event
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         The first contact for a specified entity downstream from the entities of interest.
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
      </StyledTableCell>
   </StyledTableRow>
</StyledTable>

The diagrams below demonstrate how the Trace Proximity Events task processes your data. In these diagrams, time is on
the x-axis.

In each diagram there are four entities: A, B, C, and D. The highlighted text describes the trace events that occur
between two entities (the from and to entities) and the depth of the proximity event. In this example, entity C is the
entity of interest that you are tracing downstream from.

Entity C is your chosen entity of interest. The depth is 0.

![Four entities (A, B, C, and D)  moving through space with the path of travel of entity C highlighted  with the label Entity of interest](../../images/GUID-C14B8B36-8A23-42DA-9BCE-C39B3615AACD-web.png)

A proximity event occurs between entities C and B. The depth of the trace is 1. When multiple features are subsequent
proximity events, this is a sustained proximity event.

![Entities C and B traveling near each other with a blue box labeled Depth = 1 highlighting the near event ](../../images/GUID-38CD5010-45B4-4CB2-A8FB-054258879925-web.png)

A proximity event occurs between B and A. The depth of the trace is 2. 

![Entities B and A traveling near each other with a blue box labeled Depth = 2 highlighting the near event](../../images/GUID-E45539A8-B009-4BFD-9C29-F5A8B3BBAB30-web.png)

A proximity event occurs between C and D. The depth of the trace is 1.

![Entities C and D traveling near each other with a blue box labeled Depth = 1 highlighting the near event](../../images/GUID-27FF96B8-00F8-47F6-BBD7-2BC3ADEA8F3A-web.png)

Entities are considered near each other when they meet both the distance and time requirements. The images below show
two features (red and blue). In Figure A, the two features are within a spatial search distance of each other. In
Figure B, the two features are within the temporal search distance of each other.

![Entity of interest with a search radius drawn around it and a nearby entity within the search radius](../../images/GUID-93274C17-E956-4963-8B71-BA7FB363E6BB-web.png)

![Horizontal time axis with the entity of interest and a nearby entity shown along the axis within a search range](../../images/GUID-47E8A8DD-529E-417F-9309-078FF07C63D0-web.png)

## Request parameters

<StyledTable headers={"Parameter,Details"}>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `inputPoints`
         (Required)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         The time-enabled point features that will be traced.
         <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_DC085569_B522_4EE0_B0B5_2F7A608B8064 />

         REST examples
         ```javascript
         //REST web example
         {"url": "https://myportal.domain.com/server/rest/services/Hosted/fish_tracks/FeatureServer/0", "filter": "Month = 'September'"}

         //REST scripting example
         "inputPoints": {"url": "https://myportal.domain.com/server/rest/services/Hosted/fish_tracks/FeatureServer/0", "filter": "Month = 'September'"}
         ```
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `entityIdField`
         (Required)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         The field used to identify distinct entities.

         REST examples
         ```javascript
         //REST web example
         BoatName

         //REST scripting Example
         "trackFields": "BoatName"
         ```
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `entitiesOfInterestIds`
         (Optional)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         JSON used to specify one or more entities that you are interested in tracing from. You can optionally include a time to start tracing from. If you do not specify a time, January 1, 1970, at 12:00 a.m. will be used.

         `entitiesOfInterestIds`  is required if `entitiesOfInterestLayer`  is not specified.

         REST examples
         ```javascript
         //REST web example
         [{
         "entityId": "user1",
         "epochTimeStamp": 1598390663000
         }, {
         "entityId": "user2",
         "epochTimeStamp": null
         }, {
         "entityId": "user3",
         "epochTimeStamp": 1598390663000
         }]

         //REST scripting example
         "extentOutput": [{
         "entityId": "user1",
         "epochTimeStamp": 1598390663000
         }, {
         "entityId": "user2",
         "epochTimeStamp": null
         }, {
         "entityId": "user3",
         "epochTimeStamp": 1598390663000
         }]
         ```
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `entitiesOfInterestLayer`
         (Optional)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         A feature class used to specify one or more entities that you are interested in tracing from.

         `entitiesOfInterestLayer` is required if `entitiesOfInterestIds` is not specified.
         <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_DC085569_B522_4EE0_B0B5_2F7A608B8064 />

         REST examples
         ```javascript
         //REST web example
         {"url": "https://myportal.domain.com/server/rest/services/Hosted/fish_tracks/FeatureServer/0", "filter": "Month = 'September'"}

         //REST scripting example
         "inputLayer": {"url": "https://myportal.domain.com/server/rest/services/Hosted/fish_tracks/FeatureServer/0",
         ```
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `distanceMethod`
         (Required)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         The distance type that will be used for the `spatialSearchDistance`. The default is `Geodesic`.

         Values: `Geodesic` \| `Planar`

         REST examples
         ```javascript
         //REST web example
         Planar

         //REST scripting example
         "distanceMethod": "Planar"
         ```
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `spatialSearchDistance`
         (Required)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         The maximum distance between two points to be considered in proximity. Features closer together in space and that also meet `temporalSearchDistance` criteria are considered in proximity of each other.

         REST examples
         ```javascript
         //REST web example
         6

         //REST scripting example
         "spatialSearchDistance": 6
         ```
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `spatialSearchDistanceUnit`
         (Required)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         The unit of `spatialSearchDistance` .
         <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_8280F941_0439_4805_B034_1E224F28280C />

         REST examples
         ```javascript
         //REST web example
         Feet

         //REST scripting example
         "spatialSearchDistanceUnit": "Feet"
         ```
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `temporalSearchDistance`
         (Required)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         The maximum duration between two points that are considered in proximity. Features closer together in time and that also meet the `spatialSearchDistance` criteria are considered in proximity of each other.

         REST examples
         ```javascript
         //REST web example
         2

         //REST scripting example
         "temporalSearchDistance": 2
         ```
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `temporalSearchDistanceUnit`
         (Required)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         The unit of `temporalSearchDistance`. Required if `temporalSearchDistance` is specified.
         <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_A7CEF6BC_29BB_4AF8_9B53_DC19BA1D336E />

         REST examples
         ```javascript
         //REST web example
         Meters

         //REST scripting example
         "temporalSearchDistanceUnit": "Meters"
         ```
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `includeTracksLayer`
         (Required)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         Determines whether or not an additional layer will be created containing the first trace event in tracks and all subsequent features. The default is `false`.

         REST examples
         ```javascript
         //REST web example
         true

         //REST scripting example
         "includeTracksLayer": true
         ```
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `maxTraceDepth`
         (Optional)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         The maximum degrees of separation between an entity of interest and an entity further down the trace.

         REST examples
         ```javascript
         //REST web example
         5

         //REST scripting example
         "maxTraceDepth":10
         ```
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `attributeMatchCriteria`
         (Optional)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         One or more attributes used to constrain the proximity events. Entities will only be considered near when the `spatialSearchDistance` and `temporalSearchDistance` criteria are met and the two entities have equal values of the attributes specified.

         REST examples
         ```javascript
         //REST web example
         building_level,building_name

         //REST scripting example
         "inputLayer": "building_level,building_name"
         ```
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `outputName`
         (Required)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         The name of the result feature layer that will be created.
         <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_4CB6D607_FF60_4C68_AFA1_8780CFFA421D />
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `context`
         (Optional)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_E671F554_89D2_4CAD_B032_525E1CE90C18 />
         <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_9BD8524A_A4D0_4128_876A_6CA8568233A7 />
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `f`
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_9B5D5783_E386_45F7_8EA8_88843A1BB484 />
         <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_C771449E_6BA7_4CB4_9328_2C855A14B2B2 />
      </StyledTableCell>
   </StyledTableRow>
</StyledTable>

## Example usage

Below is a sample request URL for `TraceProximityEvents`:

```javascript
https://hostname.domain.com/webadaptor/rest/services/System/GeoAnalyticsTools/GPServer/TraceProximityEvents/submitJob?inputLayer={"url":"https://hostname.domain.com/webadaptor/rest/services//employee_tracks/0"}&entityIdField=450&entitiesOfInterestRecordSet={"url":"https://hostname.domain.com/webadaptor/rest/services/eoi_subset/0"}&spatialSearchDistance=5&spatialSearchDistanceUnit=Meters&temporalSearchDistance=30&temporalSearchDistanceUnit=Seconds&maxTraceDepth=10&outputName=trace_events&f=json
```

## Response

<GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_9562E716_BEF8_4A70_A787_C7231BB32C3E />

<GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_CBCE73F1_60C0_4D53_BDE3_B2C3ACEBD24A />

<GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_EE2D677C_9158_4D61_A164_2444C6476C92 />

```javascript
https://<analysis url>/TraceProximityEvents/jobs/<jobId>
```

### Access results

<GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_03071520_C169_41C0_8E51_866D82061408 />

```javascript
https://<analysis-url>/TraceProximityEvents/jobs/<jobId>/results/output?token=<your token>&f=json
```

<StyledTable headers={"Response,Description"}>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `output`
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         The point layer of proximity events. Only the first proximity event for each entity in the trace will be included.
         ```javascript
         {"url": "https://<analysis-url>/TraceProximityEvents/jobs/<jobId>/results/output"}
         ```
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `tracksLayer`
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         An optional point layer containing the first observation of each entity in the trace and every observation after that time. `tracksLayer` will be created if `includeTracksLayer` is set to `true`. This result is useful for showing the path of travel of entities after they've come into proximity with entities in the trace.
         ```javascript
         {"url": "https://<analysis-url>/TraceProximityEvents/jobs/<jobId>/results/tracksLayer"}
         ```
      </StyledTableCell>
   </StyledTableRow>
</StyledTable>
