---
title: "Build Multi-Variable Grid"
description: "API reference for the Build Multi-Variable Grid task available in ArcGIS GeoAnalytics Server."
slug: "build-multi-variable-grid"
url: "/geoanalytics/tasks/build-multi-variable-grid"
redirectFrom:
  - /build-multi-variable-grid/
guid: "GUID-DF8B71FB-7D87-4C49-A8E8-B27CB376DA9B"
migratedTopicMetadata:
  FTITLE: "Build Multi-Variable Grid"
  FDESCRIPTION: "Template conversion"
  FCHANGES: "GeoAnalytics template conversion"
  FISHRELEASELABEL: ""
  FESRISOFTWARERELEASE: ""
  FESRITAGCLOUD: ""
  FESRIRECREATIONPROCEDURE: ""
  FESRIPRODUCTLIFECYCLE: "10.7 - *"
  CREATED-ON: "18/06/2019 08:12:03"
  FAUTHOR: "tohara"
  FSTATUS: "Released"
  MODIFIED-ON: "01/10/2019 17:38:54"
  VERSION: "1"
  FRESOLUTION: ""
  DOC-LANGUAGE: "en"
  FISHREVCOUNTER: "22"
  ED: "GUID-E4274739-2A30-4230-9A11-AAE78688DDF4"
  FUSERGROUP: "VUSERGROUPARCGISONLINEDOC"
  READ-ACCESS: ""
restInfoMetadata:
  apiPath: /BuildMultiVariableGrid
  urlSegments:
    - name: <geoanalytics-url>
      url: /geoanalytics-tasks
    - name: /BuildMultiVariableGrid
  methods: []
  sslOnly: 'no'
  versionIntroduced: 10.6.1
---

import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_E865B21A_4ACA_493E_89BA_297EB71E7033 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-E865B21A-4ACA-493E-89BA-297EB71E7033";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_8280F941_0439_4805_B034_1E224F28280C from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-8280F941-0439-4805-B034-1E224F28280C";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_UL_0C30F4A91AF54AFCA13764B42F982CF1 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_UL_0C30F4A91AF54AFCA13764B42F982CF1";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_B66A5391_775F_4E9A_B717_F84D52A10572 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-B66A5391-775F-4E9A-B717-F84D52A10572";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_E671F554_89D2_4CAD_B032_525E1CE90C18 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-E671F554-89D2-4CAD-B032-525E1CE90C18";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_9BD8524A_A4D0_4128_876A_6CA8568233A7 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-9BD8524A-A4D0-4128-876A-6CA8568233A7";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_9B5D5783_E386_45F7_8EA8_88843A1BB484 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-9B5D5783-E386-45F7-8EA8-88843A1BB484";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_C771449E_6BA7_4CB4_9328_2C855A14B2B2 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-C771449E-6BA7-4CB4-9328-2C855A14B2B2";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_9562E716_BEF8_4A70_A787_C7231BB32C3E from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-9562E716-BEF8-4A70-A787-C7231BB32C3E";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_CBCE73F1_60C0_4D53_BDE3_B2C3ACEBD24A from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-CBCE73F1-60C0-4D53-BDE3-B2C3ACEBD24A";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_EE2D677C_9158_4D61_A164_2444C6476C92 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-EE2D677C-9158-4D61-A164-2444C6476C92";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_03071520_C169_41C0_8E51_866D82061408 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-03071520-C169-41C0-8E51-866D82061408";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_A0501D59_23F2_456F_AAFF_3BCC593D9E34 from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-A0501D59-23F2-456F-AAFF-3BCC593D9E34";
import GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_A771740E_17FA_47C6_A2FC_6BF0B76090CA from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_GUID-A771740E-17FA-47C6-A2FC-6BF0B76090CA";
import GAX_DEPRECATION_NOTICE from "../../snippets/GUID-53340951-6261-4C65-BAA3-4AF9D206C6D2/_gax-general-deprecation-notice.mdx";

## Description

<GAX_DEPRECATION_NOTICE />

![Build Multi-Variable Grid](../../images/GUID-49422339-13C4-46A3-867A-E18528A3BE95-web.png)

The `BuildMultiVariableGrid` operation works with one or more layers of point, line, or polygon features. The task generates a grid of square or hexagonal bins and compiles information about each input layer into each bin. For each input layer, this information can include the following variables:

- `DistanceToNearest`—The distance from each bin to the nearest feature.
- `AttributeOfNearest`—An attribute value of the feature nearest to each bin.
- `AttributeSummaryOfRelated`—A statistical summary of all features within `searchDistance` of each bin.

Only variables you specify in `variableCalculations` will be included in the result layer. These variables can help you understand the proximity of your data throughout the extent of your analysis. The results can help you answer questions such as the following:

- Given multiple layers of public transportation infrastructure, what part of the city is least accessible by public transportation?
- Given layers of lakes and rivers, what is the name of the water body closest to each location in the United States?
- Given a layer of household income, where in the United States is the variation of income greatest in the surrounding 50 miles?

The result of `BuildMultiVariableGrid` can also be used in prediction and classification workflows. The task allows you to calculate and compile information from many different data sources into a single, spatially continuous layer in one step. This layer can then be used with the [EnrichFromMultiVariableGrid](/enrich-from-multi-variable-grid) operation to quickly enrich point features with the variables you have calculated, reducing the amount of effort required to build prediction and classification models from point data.

## Request parameters

<StyledTable headers={"Parameter,Details"}>
    <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
        `binType`
        (Required)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
        The type of bin that will be used to generate the result grid. The default is `Square`.
        <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_E865B21A_4ACA_493E_89BA_297EB71E7033 />
        Values: `Hexagon` \| `Square`

        REST examples
        ```javascript
        //REST web example
        Hexagon

        //REST scripting example
        "binType": "Hexagon"
        ```
      </StyledTableCell>
    </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">
      `binSize`
      (Required)
    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">
      The distance for the bins of type `binType` in the output polygon layer. `variableCalculations` will be calculated at the center of each bin. When generating `Square` bins, the number and units specified determine the height and length of the square. For `Hexagon` bins, the number and units specified determine the distance between parallel sides.

      REST examples
      ```javascript
      //REST web example
      108.3

      //REST scripting example
      "binSize": 100
      ```
    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">
      `binSizeUnit`
      (Required)
    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">
      The distance unit for the bins will be used to calculate `variableCalculations`.
      <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_8280F941_0439_4805_B034_1E224F28280C />

      REST examples
      ```javascript
      //REST web example
      Meters

      //REST scripting example
      "binSizeUnit": "Miles"
      ```
    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">
      `inputLayers`
      (Required)
    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">
      A list of input layers that will be used in analysis. Each input layer follows the same formatting as described in the [Feature Input](/geoanalytics-feature-input) topic. This can be one of the following:
      <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_UL_0C30F4A91AF54AFCA13764B42F982CF1 />
      In the REST web example for `inputLayers` below, two layers are being used in analysis. The layer at index 0 will be filtered to only use features where `OID` is greater than 2.

      REST web example
      ```javascript
      [
        {
           "url":"https://myportal.domain.com/server/rest/services/Hosted/hurricaneTrack/FeatureServer/0", "filter":"OID > 2"
        },
        {
           "url":"https://myportal.domain.com/server/rest/services/Hosted/weatherPoints/FeatureServer/0"
        }
      ]
      ```
    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">
      `variableCalculations`
      (Required)
    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">
      A JSON array containing objects that describe the variables that will be calculated for each layer in `inputLayers`.
    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">
      `outputName`
      (Required)
    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">
      <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_B66A5391_775F_4E9A_B717_F84D52A10572 />

      REST examples
      ```javascript
      //REST web example
      myOutput

      //REST scripting example
      "outputName": "myOutput"
      ```
    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">
      `context`
      (Optional)
    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">
      <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_E671F554_89D2_4CAD_B032_525E1CE90C18 />
      <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_9BD8524A_A4D0_4128_876A_6CA8568233A7 />
    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">
      `f`
    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">
      <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_9B5D5783_E386_45F7_8EA8_88843A1BB484 />
      <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_C771449E_6BA7_4CB4_9328_2C855A14B2B2 />
    </StyledTableCell>
  </StyledTableRow>
</StyledTable>

## variableCalculations syntax and examples

The following sections outline how to populate the `variableCalculations` parameter.

### variableCalculations syntax

In the syntax example below, "layer" is the index of the layer in `inputLayers` that will be used to calculate the specified variables; variables are an array of JSON objects that describe the variables you want to include in the result layer and must contain at least one variable for each layer; and type can be one of the following variable types:
- `DistanceToNearest`
- `AttributeOfNearest`
- `AttributeSummaryOfRelated`

Each type must be configured with a unique set of parameters, defined in the table below:
<StyledTable headers={"Parameter,Details"}>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">
      `outFieldName`
    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">
      The name of the field that will be created in the result layer to store a variable.
    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">
      `searchDistance`
    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">
      Defines the maximum distance that the tool will search from the center of each bin to find a feature in the layer for `DistanceToNearest` and `AttributeOfNearest`. If no feature is within the distance, `null` is returned. For `AttributeOfSummaryRelated` , `searchDistance` is optional and defines the radius of a circular neighborhood surrounding each bin. All features that intersect this neighborhood will be used to calculate `statisticType`. If a distance is not defined, only features that intersect a bin will be used to calculate `statisticType`.
    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">
      `searchDistanceUnit`
    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">
      Defines the maximum distance unit that the tool will search from the center of each bin to find a feature in the layer for `DistanceToNearest` and `AttributeOfNearest`. If no feature is within the distance, `null` is returned. For `AttributeOfSummaryRelated` , `searchDistance` is optional and defines the radius of a circular neighborhood surrounding each bin. All features that intersect this neighborhood will be used to calculate `statisticType`. If a distance is not defined, only features that intersect a bin will be used to calculate `statisticType`.
    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">
      `attributeField`
    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">
      The name of a field in the input layer. The value of this field in the closest feature to each bin will be included in the result layer. Required by `AttributeOfNearest`.
    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">
      `statisticField`
    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">
      The name of a field in the input layer. The field's values will be used to calculate `statisticType`. Required by `AttributeSummaryOfRelated`.
    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">
      `statisticType`
    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">
      Required by `AttributeSummaryOfRelated`. Can be defined as one of the following types:

      - `Count`—For a numeric field, this totals the number of features near or intersecting each bin. For a string field, this totals the number of strings for all features near or intersecting each bin.
      - `Sum`—Adds the total value of all features near or intersecting each bin. This is used for numeric fields.
      - `Mean`—Calculates the average of all features near or intersecting each bin. This is used for numeric fields.
      - `Min`—Finds the smallest value of all features near or intersecting each bin. This is used for numeric fields.
      - `Max`—Finds the largest value of all features near or intersecting each bin. This is used for numeric fields.
      - `Range`—Finds the difference between `Min` and `Max`. This is used for numeric fields.
      - `Stddev`—Finds the standard deviation of all features near or intersecting each bin. This is used for numeric fields.
      - `Var`—Finds the variance of all features near or intersecting each bin. This is used for numeric fields.
      - `Any`—Returns a sample string of all features near or intersecting each bin. This is used for string fields.
    </StyledTableCell>
  </StyledTableRow>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">
      `filter`
    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">
      Optional for all variable types. This is formatted as described in the Feature Input topic.
    </StyledTableCell>
  </StyledTableRow>
</StyledTable>

Syntax example
```javascript
[
    {
        "layer":<index>,
        "variables":[
            {
                "type":"DistanceToNearest",
                "outFieldName":"<output field name>",
                "searchDistance":<number>,
                "searchDistanceUnit":"<unit>",
                "filter":"<filter>"
            },
            {
                "type":"AttributeOfNearest",
                "outFieldName":"<output field name>",
                "attributeField":"<field name>",
                "searchDistance":<number>,
                "searchDistanceUnit":"<unit>",
                "filter":"<filter>"
            },
            {
                "type":"AttributeSummaryOfRelated",
                "outFieldName":"<output field name>",
                "statisticType":"<statistic type>",
                "statisticField":"<field name>",
                "searchDistance":<number>,
                "searchDistanceUnit":"<unit>",
                "filter":"<filter>"
            },
            ...
        ]
    },
    ...
]
```

### variableCalculations examples
In the REST web example for `variableCalculations` below, two variables are calculated for the layer at index 0 of the `inputLayers` list. `distance_to_nearest_hurricane` is the distance from each bin center to the nearest feature where the `type` is specified as `hurricane`, and `rating_of_nearest_hurricane` is the value of field `storm_rating` in the nearest feature to each bin center. A variable named `mean_wind_speed` is calculated for the layer at index 1 of the `inputLayers` list; it is the mean value of field `wind_speed` in all features within a 20-mile radius of each bin center. All three variables are stored in the attribute table of the output layer.

REST web example for `variableCalculations`
```javascript
[
    {
        "layer":0,
        "variables":[
            {
                "type":"DistanceToNearest",
                "outFieldName":"distance_to_nearest_hurricane",
                "searchDistance":100,
                "searchDistanceUnit":"Miles",
                "filter":"type = 'hurricane'"
            },
            {
                "type":"AttributeOfNearest",
                "outFieldName":"rating_of_nearest_hurricane",
                "attributeField":"storm_rating",
                "searchDistance":100,
                "searchDistanceUnit":"Miles"
            }
        ]
    },
    {
        "layer":1,
        "variables":[
            {
                "type":"AttributeSummaryOfRelated",
                "outFieldName":"mean_wind_speed",
                "statisticType":"mean",
                "statisticField":"wind_speed",
                "searchDistance":20,
                "searchDistanceUnit":"Miles"
            }
        ]
    }
]
```
In the REST scripting example for `variableCalculations` below, two variables are calculated for the layer at index 0 of the `inputLayers` list. The variable `distance_to_nearest_hurricane` is the distance from each bin center to the nearest feature where the `type` is specified as `hurricane`, and `distance_to_nearest_trop_storm` is the equivalent variable where the `type` is `tropical storm`. Both are stored in the attribute table of the output layer.

REST scripting example for `variableCalculations`
```javascript
"variableCalculations":[
    {
        "layer":0,
        "variables":[
            {
                "type":"DistanceToNearest",
                "outFieldName":"distance_to_nearest_hurricane",
                "searchDistance":100,
                "searchDistanceUnit":"Miles",
                "filter":"type = 'hurricane'"
            },
            {
                "type":"DistanceToNearest",
                "outFieldName":"distance_to_nearest_trop_storm",
                "searchDistance":100,
                "searchDistanceUnit":"Miles",
                "filter":"type = 'tropical storm'"
            }
        ]
    }
]
```

## Example usage

Below is a sample request URL for `BuildMultiVariableGrid`:
```other
https://hostname.domain.com/webadaptor/rest/services/System/GeoAnalyticsTools/GPServer/BuildMultiVariableGrid/submitJob?inputLayer={"url":"https://hostname.domain.com/webadaptor/rest/services/Hurricane/hurricaneTrack/0"}&bintype=Hexagon&binSize=108.3&binSizeUnit=Meters&variableCalculations=[{"layer":0,"variables":[{"type":"DistanceToNearest","outFieldName":"distance_to_nearest_hurricane","searchDistance":100,"searchDistanceUnit":"Miles","filter":"type = "hurricane""},{"type":"DistanceToNearest","outFieldName":"distance_to_nearest_trop_storm","searchDistance":100,"searchDistanceUnit":"Miles","filter":"type = "tropical storm""}]}]&outputName=myOutput&context={"extent":{"xmin":-122.68,"ymin":45.53,"xmax":-122.45,"ymax":45.6,"spatialReference":{"wkid":4326}}}&f=json
```

## Response
<GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_9562E716_BEF8_4A70_A787_C7231BB32C3E />

<GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_CBCE73F1_60C0_4D53_BDE3_B2C3ACEBD24A />

<GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_EE2D677C_9158_4D61_A164_2444C6476C92 />

```other
https://<analysis url>/BuildMultiVariableGrid/jobs/<jobId>
```

### Access results

<GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_03071520_C169_41C0_8E51_866D82061408 />

```other
https://<analysis-url>/BuildMultiVariableGrid/jobs/<jobId>/results/output?token=<your token>&f=json
```

<StyledTable headers={"Response,Description"}>
  <StyledTableRow>
    <StyledTableCell cellStyle="markdown">
      `output`
    </StyledTableCell>
    <StyledTableCell cellStyle="markdown">
      The result output will always contain polygon features. The number of resulting polygons is based on `binSize`, `variableCalculations`, and the extent of the input data.
      The layer will only contain the variables specified in `variableCalculations`.
      ```other
      {"url": "https://<analysis-url>/BuildMultiVariableGrid/jobs/<jobId>/results/output"}
      ```

      <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_A0501D59_23F2_456F_AAFF_3BCC593D9E34 />
      <GUID_53340951_6261_4C65_BAA3_4AF9D206C6D2_GUID_A771740E_17FA_47C6_A2FC_6BF0B76090CA />
    </StyledTableCell>
  </StyledTableRow>
</StyledTable>