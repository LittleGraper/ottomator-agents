---
title: "Plan Routes"
description: "API reference for the Plan Routes service available on ArcGIS Online."
slug: "plan-routes"
url: "/spatial-analysis/tasks/plan-routes"
redirectFrom:
  - /plan-routes
guid: "GUID-343D7B7F-F721-46F4-9A35-D6DDAF7A1595"
migratedTopicMetadata:
  FTITLE: "Plan Routes"
  FDESCRIPTION: "REST API doc"
  FCHANGES: "Update routeCount parameter"
  FISHRELEASELABEL: ""
  FESRISOFTWARERELEASE: ""
  FESRITAGCLOUD: ""
  FESRIRECREATIONPROCEDURE: ""
  FESRIPRODUCTLIFECYCLE: "agol10.1 - *: 11.0-*"
  CREATED-ON: "01/02/2022 05:21:28"
  FAUTHOR: "vcove"
  FSTATUS: "Released"
  MODIFIED-ON: "02/03/2022 13:23:12"
  VERSION: "9"
  FRESOLUTION: ""
  DOC-LANGUAGE: "en"
  FISHREVCOUNTER: "4"
  ED: "GUID-45635502-FF23-4627-8D41-339D943ADEFC"
  FUSERGROUP: "VUSERGROUPARCGISONLINEDOC"
  READ-ACCESS: ""
restInfoMetadata: {}
---

import GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_LI_61DFBF99C00A48F8A83E3140DE0B4416 from "../../snippets/GUID-98478E86-0753-4C4D-A2EB-7DC84675B2DC/_LI_61DFBF99C00A48F8A83E3140DE0B4416";
import GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_LI_E932AF25CC1A4D09A92E26458B145CF9 from "../../snippets/GUID-98478E86-0753-4C4D-A2EB-7DC84675B2DC/_LI_E932AF25CC1A4D09A92E26458B145CF9";
import GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_LI_D2714C31891F4E04BA986D97218E38A2 from "../../snippets/GUID-98478E86-0753-4C4D-A2EB-7DC84675B2DC/_LI_D2714C31891F4E04BA986D97218E38A2";
import GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_E0E9FDE9_9A98_4EA4_9164_0E878BADF591 from "../../snippets/GUID-98478E86-0753-4C4D-A2EB-7DC84675B2DC/_GUID-E0E9FDE9-9A98-4EA4-9164-0E878BADF591";
import GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_D95DEC58_7F27_491A_AF3D_6E6A3C0A6F2D from "../../snippets/GUID-98478E86-0753-4C4D-A2EB-7DC84675B2DC/_GUID-D95DEC58-7F27-491A-AF3D-6E6A3C0A6F2D";
import GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_F9983878_A501_4BE3_BF56_ABC4A285714A from "../../snippets/GUID-98478E86-0753-4C4D-A2EB-7DC84675B2DC/_GUID-F9983878-A501-4BE3-BF56-ABC4A285714A";
import GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_05C8D533_3215_4665_8119_E88188B710EC from "../../snippets/GUID-98478E86-0753-4C4D-A2EB-7DC84675B2DC/_GUID-05C8D533-3215-4665-8119-E88188B710EC";
import GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_B883476B_8A4E_409C_971C_2BC082BDF2AD from "../../snippets/GUID-98478E86-0753-4C4D-A2EB-7DC84675B2DC/_GUID-B883476B-8A4E-409C-971C-2BC082BDF2AD";
import GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_FE13A986_9033_452E_83AF_7FD8B1350C56 from "../../snippets/GUID-98478E86-0753-4C4D-A2EB-7DC84675B2DC/_GUID-FE13A986-9033-452E-83AF-7FD8B1350C56";
import GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_33258BFF_24E9_48DC_AC9B_DB0AAD9D0868 from "../../snippets/GUID-98478E86-0753-4C4D-A2EB-7DC84675B2DC/_GUID-33258BFF-24E9-48DC-AC9B-DB0AAD9D0868";
import GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_0FDA7502_11D1_4ED0_8535_BC379FA78278 from "../../snippets/GUID-98478E86-0753-4C4D-A2EB-7DC84675B2DC/_GUID-0FDA7502-11D1-4ED0-8535-BC379FA78278";
import GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_726693EE_0CBC_4072_82E2_6C34A91E5349 from "../../snippets/GUID-98478E86-0753-4C4D-A2EB-7DC84675B2DC/_GUID-726693EE-0CBC-4072-82E2-6C34A91E5349";
import GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_630B14EA_52E1_4E67_86FE_F6E6F0E121CA from "../../snippets/GUID-98478E86-0753-4C4D-A2EB-7DC84675B2DC/_GUID-630B14EA-52E1-4E67-86FE-F6E6F0E121CA";
import GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_BCAD1BCB_EC1F_4FF5_BACA_1171DEB5013B from "../../snippets/GUID-98478E86-0753-4C4D-A2EB-7DC84675B2DC/_GUID-BCAD1BCB-EC1F-4FF5-BACA-1171DEB5013B";
import GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_4EA0954B_62E1_4D16_B2C8_3A0CA487D187 from "../../snippets/GUID-98478E86-0753-4C4D-A2EB-7DC84675B2DC/_GUID-4EA0954B-62E1-4D16-B2C8-3A0CA487D187";
import GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_D8788E05_2F9E_4C4B_BD85_2C3827D7F599 from "../../snippets/GUID-98478E86-0753-4C4D-A2EB-7DC84675B2DC/_GUID-D8788E05-2F9E-4C4B-BD85-2C3827D7F599";
import GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_04884644_A8CD_424F_9E82_BFBC940E69F3 from "../../snippets/GUID-98478E86-0753-4C4D-A2EB-7DC84675B2DC/_GUID-04884644-A8CD-424F-9E82-BFBC940E69F3";
import GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_17F01AF8_5FA9_49A8_8A33_09600EE7A0DA from "../../snippets/GUID-98478E86-0753-4C4D-A2EB-7DC84675B2DC/_GUID-17F01AF8-5FA9-49A8-8A33-09600EE7A0DA";
import GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_0B76781C_FB26_4214_B7AA_EB7BCCEA3D55 from "../../snippets/GUID-98478E86-0753-4C4D-A2EB-7DC84675B2DC/_GUID-0B76781C-FB26-4214-B7AA-EB7BCCEA3D55";
import GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_E836F966_C272_43B1_9BF9_55BA03755A13 from "../../snippets/GUID-98478E86-0753-4C4D-A2EB-7DC84675B2DC/_GUID-E836F966-C272-43B1-9BF9-55BA03755A13";

![Plan Routes](../../images/GUID-A6D9521F-EECE-4DA2-808E-61483B99AE01-web.png)

The Plan Routes task determines how to efficiently divide tasks among a mobile workforce.

You provide the input, which includes a set of stops and the number of vehicles available to visit the stops, and the tool assigns the stops to vehicles and returns routes showing how each vehicle can reach their assigned stops in the least amount of time.

With Plan Routes, mobile workforces reach more jobsites in less time, which increases productivity and improves customer service. Organizations often use Plan Routes to:

-    Inspect homes, restaurants, and construction sites
-    Provide repair, installation, and technical services
-    Deliver items and small packages
-    Make sales calls
-    Provide van transportation from spectators' homes to events

The output from Plan Routes includes a layer of routes showing the shortest paths to visit the stops; a layer of the stops assigned to routes, as well as any stops that couldn't be reached due to the given parameter settings; and a layer of directions containing the travel itinerary for each route.

<Note type={"note"}>

This task is designed to provide a simple solution to the most common uses of fleet routing, or assigning stops to routes, people, or vehicles and finding the best routes between the stops. If you require additional flexibility to solve a more specialized problem, consider using the [Vehicle Routing Problem Service](http://developers.arcgis.com/rest/network/api-reference/vehicle-routing-problem-service.htm) instead. It provides many more options, such as honoring time windows at stops; adding barriers to block portions of the road network; setting vehicle-specific limits on maximum travel time, maximum number of stops to visit, and so on.

</Note>

## Licensing

As described in the [Get Started](http://developers.arcgis.com/rest/analysis/api-reference/getting-started.htm) topic, in order to use any analysis task, the administrator of the organization needs to grant you certain basic privileges. To use Plan Routes, you also need to be granted the **Network Analysis** privilege.

## Limits

-   `stopsLayer`—Maximum 2,000 features.
-   `routeCount`—Maximum 100.
-   `maxStopsPerRoute`—Maximum 200.
-   <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_LI_61DFBF99C00A48F8A83E3140DE0B4416 />
-   <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_LI_E932AF25CC1A4D09A92E26458B145CF9 />
-   <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_LI_D2714C31891F4E04BA986D97218E38A2 />
-   An error will occur if the tool takes more than four hours to execute. If this error occurs, try rerunning the analysis with fewer input features.

##  Request URL

```javascript
http://<analysis url>/PlanRoutes/submitJob
```

## Request Parameters
<StyledTable headers={"Parameter,Details"}>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `stopsLayer`

         (Required)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         The points that the vehicles, drivers, or routes, should visit.

         The fields on the input stops are included in the output stops, so if your input layer has a field such as Name, Address, or ProductDescription, that information will be available in the results.

         <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_E0E9FDE9_9A98_4EA4_9164_0E878BADF591 />

         <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_D95DEC58_7F27_491A_AF3D_6E6A3C0A6F2D />
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `routeCount`

         (Required)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         The maximum number of vehicles that are available to route. The tool supports up to 100 vehicles. The default value is 0.

         The tool may be able to find and return a solution that uses fewer vehicles than the number you specify for this parameter. The number of vehicles returned also depends on four other parameters: the total number of stops in `stopsLayer`, the number of stops per vehicle you allow (`maxStopsPerRoute`), the travel time between stops, the time spent at each stop (`stopServiceTime`), and any limit you set on the total route time per vehicle (`maxRouteTime`).

         Example:`"routeCount": 8`
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `maxStopsPerRoute`

         (Required)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         The maximum number of stops a route, or vehicle, is allowed to visit. The largest value you can specify is 200. The default value is zero.

         This is one of two parameters that balance the overall workload across routes. The other is `maxRouteTime`.

         By lowering the maximum number of stops that can be assigned to each vehicle, the vehicles are more likely to have an equal number of stops assigned to them. This helps balance workloads among drivers. The drawback, however, is that it may result in a solution that is less efficient.

         By increasing the stops per vehicle, the tool has more freedom to find more efficient solutions; however, the workload may be unevenly distributed among drivers and vehicles. Note that you can balance workloads by time instead of number of stops by specifying a value for the `maxRouteTime` parameter.

         The following examples demonstrate the effects of limiting the maximum stops per vehicle or the total time per vehicle. In all of these examples, two routes start at the same location and visit a total of six stops.
         <StyledTable headers={""}>
            <StyledTableRow>
               <StyledTableCell cellStyle="markdown">
                  ![Balanced stops and travel times](../../images/GUID-820BDC1E-97CB-457F-9235-7105D274AFEB-web.png)
               </StyledTableCell>
               <StyledTableCell cellStyle="markdown">
                  Balanced travel times and stops per route:

                  The stops are more or less uniformly spread apart, so setting `maxStopsPerRoute=3` to evenly distribute the workload results in routes that are roughly the same duration.
               </StyledTableCell>
            </StyledTableRow>
            <StyledTableRow>
               <StyledTableCell cellStyle="markdown">
                  ![Unbalanced route times](../../images/GUID-813F72FE-500D-4A4D-A030-B3450F09154B-web.png)
               </StyledTableCell>
               <StyledTableCell cellStyle="markdown">
                  Balanced stops per route but unbalanced travel times:

                  Five of the six stops are clustered near the starting location, but one stop is set apart and requires a much longer drive to be reached. Dividing the stops equally between the two routes (`maxStopsPerRoute=3`) causes unbalanced travel times.
               </StyledTableCell>
            </StyledTableRow>
            <StyledTableRow>
               <StyledTableCell cellStyle="markdown">
                  ![Balanced travel times](../../images/GUID-082615A2-7F07-49AB-92AF-C82CEB813E6F-web.png)
               </StyledTableCell>
               <StyledTableCell cellStyle="markdown">
                  Unbalanced stops per route but balanced travel times:

                  The stops are in the same location as the previous graphic. By increasing the value of `maxStopsPerRoute` to `4`, and limiting the total travel time per vehicle (`maxRouteTime`), the travel times are balanced even though one route visits more stops.
               </StyledTableCell>
            </StyledTableRow>
         </StyledTable>

         Example: `"maxStopsPerRoute": 3`
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `routeStartTime`

         (Required)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         Specify when the vehicles or people start their routes. The time is specified as Unix time (milliseconds since midnight, January 1 1970).

         The starting time value is the same for all routes; that is, all routes start at the same time.

         Time zones affect what value you assign to `routeStartTime`. The time zone for the start time is based on the time zone in which the starting point is geographically located. For instance, if you have one route starting location and it is located in Pacific Standard Time (PST), the time you specify for `routeStartTime` is in PST.

         There are a couple of scenarios to beware of given that starting times are based on where the starting points are located. One situation to be careful of is when you are located in one time zone but your starting locations are in another times zone. For instance, assume you are in Pacific Standard Time (UTC-8:00) and the vehicles you are routing are stationed in Mountain Standard Time (UTC-7:00). If it is currently 9:30 a.m. PST (10:30 a.m. MST) and your vehicles need to begin their routes in 30 minutes, you would set the start time to 11:00 a.m. That is, the starting locations for the routes are in the Mountain time zone, and it is currently 10:30 a.m. there, therefore, a starting time of 30 minutes from now is 11:00 a.m. Make sure you set the parameter according to the proper time zone.

         The other situation that requires caution is where starting locations are spread across multiple time zones. The time you set for `routeStartTime` is specific to the time zone in which the starting location is—regardless of whether there are one or more starting locations in the problem you submit. For instance, if one route starts from a point in PST and another route starts from MST, and you enter 11:00 a.m. as the start time, the route in PST will start at 11:00 a.m. PST and the route in MST will start at 11:00 a.m. MST—a one-hour difference. The starting times are the same in local time, but offset in actual time, or UTC.

         The service automatically determines the time zones of the input starting locations (`startLayer`) for you.

         Examples:
         -   `"timeOfDay": 1413964800000` // 8:00, 22 October 2014. Routes will depart their starting locations at 8:00 a.m., 22 October. Any routes with starting points in Mountain Standard Time start at 8:00 a.m., 22 October 2014 MST; any routes with starting points in Pacific Standard Time start at 8:00 a.m. 22 October 2014 PST, and so on.
         -   `"timeOfDay": 1426674000000` // 10:20, 18 March 2015.
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `startLayer`

         (Required)
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         Provide the locations where the people or vehicles start their routes. You can specify one or many starting locations.

         If specifying one, all routes will start from the one location. If specifying many starting locations, each route needs exactly one predefined starting location, and the following criteria must be met:
         -   The number of routes (`routeCount`) must equal the number of points in `startLayer`. (However, when only one point is included in `startLayer`, it is assumed that all routes start from the same location, and the two numbers can be different.)
         -   The starting location for each route must be identified with the `startLayerRouteIDField` parameter. This implies that the input points in `startLayer` have a unique identifier. Bear in mind that if you also have many ending locations, those locations need to be predetermined as well. The predetermined start and end locations of each route are paired together by matching route ID values.

         See the section of this topic entitled [Starting and ending locations of routes](http://developers.arcgis.com/rest/analysis/api-reference/plan-routes.htm#ESRI_SECTION1_29AC345FE2394D81B458E667A3ED263D) to learn more.

         <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_E0E9FDE9_9A98_4EA4_9164_0E878BADF591 />

         <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_D95DEC58_7F27_491A_AF3D_6E6A3C0A6F2D />
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `startLayerRouteIDField`
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         Choose a field that uniquely identifies points in `startLayer`. This parameter is required when `startLayer` has more than one point; it is ignored otherwise.

         The `startLayerRouteIDField` parameter helps identify where routes begin and indicates the names of the output routes.

         See the the section of this topic entitled [Starting and ending locations of routes](http://developers.arcgis.com/rest/analysis/api-reference/plan-routes.htm#ESRI_SECTION1_29AC345FE2394D81B458E667A3ED263D) to learn more.

         Example: `"startLayerRouteIDField": "DriverName"`
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `returnToStart`
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         A `true` value indicates each route must end its trip at the same place where it started. The starting location is defined by the `startLayer` and `startLayerRouteIDField` parameters.

         The default value is `true`.

         Example: `"returnToStart": "false"`
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `endLayer`
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         Provide the locations where the people or vehicles end their routes.

         If `endLayer` is not specified, `returnToStart` must be set to `true`.

         You can specify one or many ending locations.

         If specifying one, all routes will end at the one location. If specifying many ending locations, each route needs exactly one predefined ending location, and the following criteria must be met:
         -   The number of routes (`routeCount`) must equal the number of points in `endLayer`. (However, when only one point is included in `endLayer`, it is assumed that all routes end at the same location, and the two numbers can be different.)
         -   The ending location for each route must be identified with the `endLayerRouteIDField` parameter. This implies that the input points in `endLayer` have a unique identifier. Bear in mind that if you also have many starting locations, those locations need to be predetermined as well. The predetermined start and end locations of each route are paired together by matching route ID values.

         See the the section of this topic entitled [Starting and ending locations of routes](http://developers.arcgis.com/rest/analysis/api-reference/plan-routes.htm#ESRI_SECTION1_29AC345FE2394D81B458E667A3ED263D) to learn more.

         <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_E0E9FDE9_9A98_4EA4_9164_0E878BADF591 />

         <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_D95DEC58_7F27_491A_AF3D_6E6A3C0A6F2D />
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `endLayerRouteIDField`
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         Choose a field that uniquely identifies points in `endLayer`. This parameter is required when `endLayer` has more than one point; it is ignored if there is one point or if `returnToStart` is `true`.

         The `endLayerRouteIDField` parameter helps identify where routes end and indicates the names of the output routes.

         See the the section of this topic entitled [Starting and ending locations of routes](http://developers.arcgis.com/rest/analysis/api-reference/plan-routes.htm#ESRI_SECTION1_29AC345FE2394D81B458E667A3ED263D) to learn more.

         Example: `"endLayerRouteIDField": "Name"`
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `travelMode`
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_F9983878_A501_4BE3_BF56_ABC4A285714A />

         <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_05C8D533_3215_4665_8119_E88188B710EC />

         <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_B883476B_8A4E_409C_971C_2BC082BDF2AD />

         <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_FE13A986_9033_452E_83AF_7FD8B1350C56 />

         <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_33258BFF_24E9_48DC_AC9B_DB0AAD9D0868 />

         <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_0FDA7502_11D1_4ED0_8535_BC379FA78278 />

         <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_726693EE_0CBC_4072_82E2_6C34A91E5349 />

         <Note type={"caution"}>
            Plan Routes task only supports time-based travel modes, i.e. travel modes that specify a time-based impedance attribute. A travel mode is time-based if the `impedanceAttributeName` property has the same value as the `timeAttributeName` property in the travel mode JSON. A distance based value for the `travelMode` parameter causes a failure.
         </Note>
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `stopServiceTime`
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         Indicates how much time, in minutes, is spent at each stop. The units are minutes. All stops are assinged the same service duration from this parameter—unique values for individual stops cannot be specified with this service.

         Example: `"stopServiceTime": 10` //The routes will spend 10 minutes at each visited stop.
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `maxRouteTime`
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         The amount of time you specify here limits the maximum duration of each route. The maximum route time is an accumulation of travel time and the total service time at visited stops (`stopServiceTime`). This parameter is commonly used to prevent drivers from working too many hours or to balance workloads across routes or drivers.

         The units are minutes. The default value, which is also the maximum value, is `525600` minutes, or one year.

         Example: `"maxRouteTime": 600` //None of the routes can last longer than 600 minutes, or 10 hours.
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `includeRouteLayers`
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_630B14EA_52E1_4E67_86FE_F6E6F0E121CA />

         <Note type={"caution"}>
            Route layers cannot be created when the output is a feature collection. The task will produce an error if an `outputName` value is not specified (which indicates feature collection output) and `includeRouteLayers` is set to `true`.
         </Note>
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `pointBarrierLayer`
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_BCAD1BCB_EC1F_4FF5_BACA_1171DEB5013B />

         <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_4EA0954B_62E1_4D16_B2C8_3A0CA487D187 />

         <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_E0E9FDE9_9A98_4EA4_9164_0E878BADF591 />

         <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_D95DEC58_7F27_491A_AF3D_6E6A3C0A6F2D />
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `lineBarrierLayer`
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_D8788E05_2F9E_4C4B_BD85_2C3827D7F599 />

         <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_04884644_A8CD_424F_9E82_BFBC940E69F3 />

         <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_E0E9FDE9_9A98_4EA4_9164_0E878BADF591 />

         <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_D95DEC58_7F27_491A_AF3D_6E6A3C0A6F2D />
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `polygonBarrierLayer`
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_17F01AF8_5FA9_49A8_8A33_09600EE7A0DA />

         <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_0B76781C_FB26_4214_B7AA_EB7BCCEA3D55 />

         <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_E0E9FDE9_9A98_4EA4_9164_0E878BADF591 />

         <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_D95DEC58_7F27_491A_AF3D_6E6A3C0A6F2D />
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `outputName`
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         <GUID_98478E86_0753_4C4D_A2EB_7DC84675B2DC_GUID_E836F966_C272_43B1_9BF9_55BA03755A13 />
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `context`
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         [Context](../../reference/spatial-reference) contains additional settings that affect task execution. For Plan Routes, there are two settings:
         1.  [Extent](../../reference/spatial-reference#extent) (`extent`)—A bounding box that defines the analysis area. Only those points in the `inputLayer`, `startLayer`, and `endLayer` that are within the bounding box can be visited by routes.
         2.  [Output spatial reference](../../reference/spatial-reference#output-spatial-reference) (`outSR`)
         -   If the output is a feature service, the spatial reference will be the same as `stopslayer`. Setting `outSR` for feature services has no effect.
         -   If the output is a feature collection, the features will be in the spatial reference of the `outSR` value or the spatial reference of `stopsLayer` when `outSR` is not specified.

         Syntax:
         ```javascript
         {
         "extent" : {extent}
         "outSR" : {spatial reference}
         }
         ```
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `f`
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         The response format. The default response format is `html`.

         Values: `html` \| `json`
      </StyledTableCell>
   </StyledTableRow>
</StyledTable>

## Response
When you submit a request, the service assigns a unique job ID for the transaction.
Syntax:
```javascript
{
"jobId": "<unique job identifier>",
"jobStatus": "<job status>"
}
```
After the initial request is submitted you can use the `jobId` to periodically check the status of the job and messages as described in the topic [Check job status](/checking-job-status-1). Once the job has successfully completed, you use the `jobId` to retrive the results. To track the status, you can make a request of the following form:
```javascript
http://<analysis url>/PlanRoutes/jobs/<jobId>
```
## Accessing results
When the status of the job request is `esriJobSucceeded`, you can access the results of the analysis by making a request of the following form.
```javascript
http://<analysis url>/PlanRoutes/jobs/<jobId>/results/<output parameter name>?token=<your token>&f=json
```
<StyledTable headers={"Parameter,Description"}>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `routesLayer`
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         The output routes that visit the assigned stops.

         Example:
         ```javascript
         {"url":"http://<analysis url>/PlanRoutes/jobs/<jobId>/results/RoutesLayer"}
         ```
         The result has properties for parameter name, data type, and value. The contents of value depends upon the `outputName` parameter provided in the initial request.
         -   If `outputName` was provided, `value` contains the url to the feature service layer.
         ```javascript
         {
        "paramName":"routesLayer",
        "dataType":"GPString",
        "value":{"url":"<hosted featureservice layer url>"}
        }
         ```
         -   If `outputName` was not provided, `value` contains a feature collection.
         ```javascript
         {
         "paramName":"routesLayer",
         "dataType":"GPString",
         "value":{"layerDefinition": {}, "featureSet": {}  }
         }
         ```
         See [Feature Output ](/feature-output-1) for more information about how the result layer or collection is accessed.

         _Fields in the output_:
         -   `RouteName`—The name of the route. The name is automatically generated if one starting and one ending location is provided; the name is derived from the field value of `startLayerRouteIDField` or `endLayerRouteIDField` when many starting or ending locations are provided.
         -   `StopCount`—The total number of stops assigned to the route. The stop count excludes the two starting and ending points of a route.
         -   `TotalTime`—The expected duration of the route, in minutes. The total time includes the total service and travel times.
         -   `TotalServiceTime`—The total time, in minutes, expected to be spent servicing stops. The total service time excludes travel time. Note that route start and route end points don't have service times.
         -   `TotalTravelTime`—The total time, in minutes, expected to be spent traveling between stops. The total travel time excludes service times.
         -   `TotalMiles`—The total expected travel distance of the route, in miles.
         -   `TotalKilometers`—The total expected travel distance of the route, in kilometers.
         -   `StartTime`—The time and date the route is expected to begin its journey. The time is presented using the time zone in which the starting point is located.
         -   `EndTime`—The time and date the route is expected to end its journey. The time is presented using the time zone in which the ending point is located.
         -   `StartTimeUTC`—The time and date the route is expected to begin its journey. The time is presented using UTC.
         -   `EndTimeUTC`—The time and date the route is expected to end its journey. The time is presented using UTC.
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `assignedStopsLayer`
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         The stops assigned to routes.

         Example:
         ```javascript
         {"url":"http://<analysis url>/PlanRoutes/jobs/<jobId>/results/AssignedStopsLayer"}
         ```
         _Fields in the output_:
         -   `RouteName`—The name of the route. The name is automatically generated if one starting and one ending location is provided; the name is derived from the field value of `startLayerRouteIDField` or `endLayerRouteIDField` when many starting or ending locations are provided.
         -   `Sequence`—The order in which the stop is visited by the route that is assigned to the stop.
         -   `ServiceTime`—The amount of time spent at the stop. The value is in minutes.
         -   `FromPrevTravelTime`—The expected travel time, in minutes, to reach the current stop from the previous stop. It is 0 for the first stop. The service times at stops are excluded from this value.
         -   `FromPrevDistance`—The expected travel distance, in miles, between the previous stop and the current stop. It is 0 for the first stop.
         -   `FromPrevDistanceKilometers`—The expected travel distance, in kilometers, between the previous stop and the current stop. It is 0 for the first stop.
         -   `ArriveTime`—The time and date the route is expected to arrive at the stop. The time is presented using the time zone in which the stop is located.
         -   `DepartTime`—The time and date the route is expected to depart the stop after any service time. The time is presented using the time zone in which the stop is located.
         -   `ArriveTimeUTC`—The time and date the route is expected to arrive at the stop. The time is presented using UTC.
         -   `DepartTimeUTC`—The time and date the route is expected to depart the stop. The time is presented using UTC.
         -   `StopType`—Indicates whether the stop represents the starting location of the route (Route start), the ending location of the route (Route end), or a typical stop along the route (Stop).
      </StyledTableCell>
   </StyledTableRow>
   <StyledTableRow>
      <StyledTableCell cellStyle="markdown">
         `unassignedStopsLayer`
      </StyledTableCell>
      <StyledTableCell cellStyle="markdown">
         The stops that couldn't be assigned to any routes.

         Example:
         ```javascript
         {"url":"http://<analysis url>/PlanRoutes/jobs/<jobId>/results/UnassignedStopsLayer"}
         ```
         _Fields in the output_:
         -   `ViolatedConstraint`—Indicates why the stop was not assigned to a route when the `Status` field has a value of Not Reached; it is blank otherwise.
         -   `Status`—Indicates whether the stop was located on a road segment (OK), not located (it was too far from a road segment), or not reached. When the value is Not Reached, the `ViolatedConstraint` field provides more information.
      </StyledTableCell>
   </StyledTableRow>
</StyledTable>
## Route names and starting and ending locations
Plan Routes determines how to assign stops to many routes. But before it can do that, it requires certain inputs that you provide, including the locations where each route starts and ends. This section describes how to set beginning and ending locations and how to associate them with specific routes, or drivers. It also describes how the output routes are automatically named given their starting or ending locations.

Several parameters can be used in combination to set the start and end points. To briefly introduce them, they are listed below with a short description of how they are relevant. These parameters are referenced in more detail in the subsections that follow.
-   `startLayer`—This parameter is always required, but what is important to know when specifying the related parameters listed here is whether `startlayer` contains one or many points.
-   `startLayerRouteIDField`—Required when more than one point is in `startLayer`.
-   `returnToStart`—Set to `true` if you want routes to end where they began; set to `false` if they end elsewhere (you must also add the `endLayer` parameter when false).
-   `endLayer`—Required when `returnToStart` is `false`; it is ignored otherwise.
-   `endLayerRouteIDField`—Required when `returnToStart` is `false` and `endLayer` contains more than one point.

The illustrations in these subsections show two routes only for simplicity. The Plan Routes tool works in the same way when more routes are specified.
### One starting point and returning to start
The most common and simplest problem to set up is one where all routes start and end at the same location. A charitable organization seeking to efficiently deliver donations to people in need parks its delivery vans at a single warehouse. On delivery days, volunteers load the vans, which then fan out to various stops to deliver the packages. The vans return to the warehouse when all the deliveries are made.

Provide the following parameters to set up this start-and-end problem type:
-   `startLayer`—Include one point to represent the starting location (for example, the warehouse).
-   `returnToStart`—Set to `true`.

![Input  for one start location and returning to start](../../images/GUID-A14FB13D-840F-4DCB-BC15-F98815873F8E-web.png)

_Input: One start location and returning to start_

The output routes start and end at the same, single location.

![Output for one start location and returning to start](../../images/GUID-137563C5-DC90-4FE1-919B-6B5F4C7CD46E-web.png)

_Output: One start location and returning to start_

It is assumed that any driver can be assigned to any route since all routes start and end at the same location; therefore, the routes are assigned generic names.
### One starting point and one ending point
Sometimes all routes start at one location and end at another. For instance, when planning routes for several buses parked at a depot that will pick up spectators from their homes and take them to an event, such as a concert, the depot is specified as the single starting location, and the venue of the event becomes the single ending location.
Provide the following parameters to solve this problem type:
-   `startLayer`—Include one point representing the starting location (for example, the bus depot).
-   `returnToStart`—Set to `false`.
-   `endLayer`—Include one point representing the ending location (for example, the concert).

![Input for one start to one end location](../../images/GUID-0DA3D4DE-E17A-42CC-8E18-78331922CBC8-web.png)

_Input: One start and one end location_

The output routes start at one location and end at another.

![Output for one start to one end location](../../images/GUID-967E35FC-3E22-4E58-91A5-ABDA5F8B59C0-web.png)

_Output: One start and one end location_
Because all drivers start and end at the same two locations, respectively, it is assumed any driver can drive any route, and therefore the output routes are generically named.
### Many starting points and returning to start
For this problem type, each route starts from a unique point, visits its assigned stops, and finishes at the place where it began. This problem type is used, for instance, to route inspectors who start the day at their homes, go to various inspection sites, and return home at the end of the day.
Provide the following parameters to solve this problem type:
-   `startLayer`—Include multiple points in this layer: one for each starting location (for example, an inspector's home). Note that each route is always assigned its own starting point for this problem type. If a subset of routes start at the same location, add their starting points next to or on top of each other to ensure each route has its own corresponding starting location.
-   `startLayerRouteIDField`—Choose the ID field for this parameter. The start layer must have a field that uniquely identifies the routes, or drivers. It can be a route number, the driver's name, or some other unique name.
-   `returnToStart`—Set to `true`.

![Input for many starting locations and returning to start](../../images/GUID-763F6A1C-F6B6-4624-A4FD-99F46920A18F-web.png)

_Input: Many start locations and returning to start_

The output routes start at multiple locations and end at their starting locations.

![Output for many starting locations and returning to start](../../images/GUID-278AEC44-432A-460D-BD38-3C147CA20EDF-web.png)

_Output: Many start locations and returning to start_

The routes and their drivers start at unique locations, so `startLayerRouteID` is specified. The output route names are automatically generated to be the same as the route ID values so that the routes can be assigned and delivered to the appropriate drivers.
### Many starting points and one ending point
Each route starts from a unique point, visits its assigned stops, and converges with the other routes at a single ending location for this problem type. For instance, school bus drivers in a rural school district park their buses at their country homes at night. In the morning, they start their routes from home, pick up students, and drop them off at one school.
Provide the following parameters to solve this problem type:
-   `startLayer`—Include multiple points in this layer: one for each starting location (for example, the bus drivers' homes). Note that each route is always assigned its own starting point for this problem type. If a subset of routes start at the same location, add their starting points next to or on top of each other to ensure each route has its own corresponding starting location.
-   `startLayerRouteIDField`—Choose the ID field for this parameter. The start layer must have a field that uniquely identifies the routes, or drivers. It can be a route number, the driver's name, or some other unique name.
-   `returnToStart`—Set to `false`.
-   `endLayer`—Include one point representing the ending location (for example, the school).

![Input for many start locations to one end](../../images/GUID-7E3C9B9A-DE33-4D87-A2D4-355EA623C618-web.png)

_Input: Many start locations and one end location_

The output routes start at multiple locations and end at one location.

![Output for many start locations to one end location](../../images/GUID-6CA9B112-42C2-4D7D-BCC1-9B78A52B0208-web.png)

_Output: Many start locations and one end location_

The routes and their drivers start at unique locations, so `startLayerRouteID` is specified. The output route names are automatically generated to be the same as the route ID values so that the routes can be assigned and delivered to the appropriate drivers.
### One starting points to many ending points
In the one-to-many problem type, all routes start from one point, visit their assigned stops, and end at unique locations. For a utility company that needs to hang shut-off warning tags on the doors of delinquent customers, employees are offered extra pay to hang the tags on their way home from work. The employees who accept the task pick up the tags from the central office, drive to various stops to hang the tags, and end their routes at their own homes.
Provide the following parameters to solve this problem type:
-   `startLayer`—Include one point representing the starting location (for example, the central office).
-   `returnToStart`—Set to `false`.
-   `endLayer`—Include multiple points in this layer: one for each ending location (for example, the employee homes). Note that each route is always assigned its own ending point for this problem type. If a subset of routes end at the same location, add their ending points next to or on top of each other to ensure each route has its own corresponding ending location.
-   `endLayerRouteIDField`—Choose the ID field for this parameter. The end layer must have a field that uniquely identifies the routes, or drivers. It can be a route number, the driver's name, or some other unique name.

![Input for one start location to many end locations](../../images/GUID-BD7A442F-CD43-44B9-81FF-61CCE006CD0F-web.png)

_Input: One start location and many end locations_

The output routes start at one location and end at multiple locations.

![Output for one start location to many end locations](../../images/GUID-2C8FFBFB-139B-420D-891B-9473E418B29D-web.png)

_Output: One start location and many end location_

The routes and their drivers end at unique locations, so `endLayerRouteID` is specified. The output route names are automatically generated to be the same as the route ID values so that the routes can be assigned and delivered to the appropriate drivers.
### Many starting points to many ending points
In some planning scenarios, each route has unique starting and ending locations.
Provide the following parameters to solve this problem type:
-   `startLayer`—Include multiple points in this layer: one for each starting location. Note that each route is always assigned its own starting point for this problem type. If a subset of routes start at the same location, add their starting points next to or on top of each other to ensure each route has its own corresponding starting location.
-   `startLayerRouteIDField`—Choose the ID field for this parameter. The start layer must have a field that uniquely identifies the routes, or drivers. It can be a route number, the driver's name, or some other unique name.
-   `returnToStart`—Set to `false`.
-   `endLayer`—Include multiple points in this layer: one for each ending location. Note that each route is always assigned its own ending point for this problem type. If a subset of routes end at the same location, add their ending points next to or on top of each other to ensure each route has its own corresponding ending location
-   `endLayerRouteIDField`—Choose the ID field for this parameter. The end layer must have a field that uniquely identifies the routes, or drivers. It can be a route number, the driver's name, or some other unique name.

![Input for many start and end locations](../../images/GUID-D226A9BF-30A1-4B98-8504-6AB3AF0A6147-web.png)

_Input: Many start and end locations_

The output routes start at many locations and end at multiple locations.

![Output for many start and end locations](../../images/GUID-604434B7-7760-49A7-AD9D-590A446F5ABC-web.png)

_Output: Many start and end locations_
