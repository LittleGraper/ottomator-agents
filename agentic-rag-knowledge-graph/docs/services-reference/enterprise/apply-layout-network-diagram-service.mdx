---
title: "Apply Layout"
description: "The applyLayout operation applies a specific diagram algorithm to a diagram or parts of a diagram."
slug: "apply-layout-network-diagram-service"
url: "/apply-layout-network-diagram-service"
guid: "GUID-23AC095B-C2A7-4F41-941D-12B77863AD7A"
migratedTopicMetadata:
  FTITLE: "Apply Layout (Network Diagram service)"
  FDESCRIPTION: "bad varef in a dive in note. This should have been be a static varref from the beginning and was not"
  FCHANGES: "Fix a bad varref in the Dive-in section. Should have referenced a static version and was not"
  FISHRELEASELABEL: ""
  FESRISOFTWARERELEASE: ""
  FESRITAGCLOUD: ""
  FESRIRECREATIONPROCEDURE: ""
  FESRIPRODUCTLIFECYCLE: "10.8 - *"
  CREATED-ON: "23/08/2023 00:44:59"
  FAUTHOR: "ablin"
  FSTATUS: "Released"
  MODIFIED-ON: "30/08/2023 01:06:31"
  VERSION: "7"
  FRESOLUTION: ""
  DOC-LANGUAGE: "en"
  FISHREVCOUNTER: "3"
  ED: "GUID-4CE04FBF-A658-4505-8AE0-432BE2D202FA"
  FUSERGROUP: ""
  READ-ACCESS: ""
restInfoMetadata:
  apiPath: /<serviceName>/NetworkDiagramServer/diagrams/<diagramName>/applyLayout
  urlSegments:
    - name: <root>
      url: /catalog
    - name: /<serviceName>/NetworkDiagramServer/diagrams/<diagramName>/applyLayout
  methods: 
    - post
  sslOnly: 'no'
  versionIntroduced: ' 10.6'
---

import GUID_975B7744_9503_41BE_A799_3D09E55A85D5_GUID_61665A7B_93DA_486F_A8E6_9346FC7AF420 from "./snippets/GUID-975B7744-9503-41BE-A799-3D09E55A85D5/_GUID-61665A7B-93DA-486F-A8E6-9346FC7AF420";
import GUID_39D57F54_1EBC_4379_8DFC_8A7E3A992DFC_GUID_F6FE67FB_9ACA_45E7_831C_DD51A831EAD3 from "./snippets/GUID-39D57F54-1EBC-4379-8DFC-8A7E3A992DFC/_GUID-F6FE67FB-9ACA-45E7-831C-DD51A831EAD3";
import GUID_39D57F54_1EBC_4379_8DFC_8A7E3A992DFC_GUID_7AC426AF_5C62_4474_BBE7_6C36CC7DCEB6 from "./snippets/GUID-39D57F54-1EBC-4379-8DFC-8A7E3A992DFC/_GUID-7AC426AF-5C62-4474-BBE7-6C36CC7DCEB6";
import GUID_39D57F54_1EBC_4379_8DFC_8A7E3A992DFC_GUID_3EB2FA97_FEE5_4CCA_85DB_1B67B3F50172 from "./snippets/GUID-39D57F54-1EBC-4379-8DFC-8A7E3A992DFC/_GUID-3EB2FA97-FEE5-4CCA-85DB-1B67B3F50172";
import GUID_39D57F54_1EBC_4379_8DFC_8A7E3A992DFC_GUID_5BD34E45_603F_4F5B_B77D_236011A78DA4 from "./snippets/GUID-39D57F54-1EBC-4379-8DFC-8A7E3A992DFC/_GUID-5BD34E45-603F-4F5B-B77D-236011A78DA4";
import GUID_39D57F54_1EBC_4379_8DFC_8A7E3A992DFC_GUID_ABFDFF0B_C205_42C8_9ABD_73DE1FE97AE0 from "./snippets/GUID-39D57F54-1EBC-4379-8DFC-8A7E3A992DFC/_GUID-ABFDFF0B-C205-42C8-9ABD-73DE1FE97AE0";
import GUID_39D57F54_1EBC_4379_8DFC_8A7E3A992DFC_GUID_17DF280A_CE78_4C37_8906_9FA8518D9989 from "./snippets/GUID-39D57F54-1EBC-4379-8DFC-8A7E3A992DFC/_GUID-17DF280A-CE78-4C37-8906-9FA8518D9989";
import GUID_39D57F54_1EBC_4379_8DFC_8A7E3A992DFC_GUID_4631762B_50EE_44C6_9461_38BDDF1BB012 from "./snippets/GUID-39D57F54-1EBC-4379-8DFC-8A7E3A992DFC/_GUID-4631762B-50EE-44C6-9461-38BDDF1BB012";
import GUID_39D57F54_1EBC_4379_8DFC_8A7E3A992DFC_GUID_7D12F246_BE1B_414F_8A39_8054E24176EB from "./snippets/GUID-39D57F54-1EBC-4379-8DFC-8A7E3A992DFC/_GUID-7D12F246-BE1B-414F-8A39-8054E24176EB";

## Description

The `applyLayout` operation applies a specific diagram algorithm to a diagram or parts of a diagram. It is performed on a [Diagram resource](/diagram-network-diagram-service). The result of this operation is a [Diagram JSON Information](/appendix-diagram-information-object-network-diagram-service) object, and the moment (date) the operation happens for a stored diagram.

<Note type={"note"}>

Starting with ArcGIS Enterprise 10.7.1, the operation can be run as an asynchronous process—`async=true` . In this case, it uses the system **UtilityNetworkTools** geoprocessing service which is reserved for utility network geoprocessing tasks and has a longer default timeout setting.

</Note>

<Note type={"note"}>

<GUID_975B7744_9503_41BE_A799_3D09E55A85D5_GUID_61665A7B_93DA_486F_A8E6_9346FC7AF420 />

</Note>

##  Request Parameters 

<StyledTable headers={"Parameter,Details"}>

<StyledTableRow>

<StyledTableCell cellStyle="markdown">

`gdbVersion` 

</StyledTableCell>

<StyledTableCell cellStyle="markdown">

<GUID_39D57F54_1EBC_4379_8DFC_8A7E3A992DFC_GUID_F6FE67FB_9ACA_45E7_831C_DD51A831EAD3 />

<GUID_39D57F54_1EBC_4379_8DFC_8A7E3A992DFC_GUID_7AC426AF_5C62_4474_BBE7_6C36CC7DCEB6 />

<GUID_39D57F54_1EBC_4379_8DFC_8A7E3A992DFC_GUID_3EB2FA97_FEE5_4CCA_85DB_1B67B3F50172 />

</StyledTableCell>

</StyledTableRow>

<StyledTableRow>

<StyledTableCell cellStyle="markdown">

`sessionId` 

</StyledTableCell>

<StyledTableCell cellStyle="markdown">

<GUID_39D57F54_1EBC_4379_8DFC_8A7E3A992DFC_GUID_5BD34E45_603F_4F5B_B77D_236011A78DA4 />

<GUID_39D57F54_1EBC_4379_8DFC_8A7E3A992DFC_GUID_ABFDFF0B_C205_42C8_9ABD_73DE1FE97AE0 />

<GUID_39D57F54_1EBC_4379_8DFC_8A7E3A992DFC_GUID_17DF280A_CE78_4C37_8906_9FA8518D9989 />

</StyledTableCell>

</StyledTableRow>

<StyledTableRow>

<StyledTableCell cellStyle="markdown">

`layoutName` 
<br />
(Required)
</StyledTableCell>

<StyledTableCell cellStyle="markdown">


The name of the algorithm layout to apply (string). The parameter accepts the following values:

- `AngleDirectedDiagramLayout`: Moves a diagram's edges in specified alignment directions. For more information see the [AngleDirectedDiagramLayout property set object](/appendix-diagram-layout-property-set-objects#AngleDirectedDiagramLayout-property-set-object) documentation or the [Apply Angle Directed Layout tool](https://pro.arcgis.com/en/pro-app/latest/tool-reference/network-diagram/apply-angle-directed-layout.htm) documentation. 
- `CompressionDiagramLayout`: Compresses the diagram features toward the middle of the diagram. For more information see the [CompressionDiagramLayout property set object](/appendix-diagram-layout-property-set-objects#compressiondiagramlayout-property-set-object) documentation or the [Apply Compression Layout tool](https://pro.arcgis.com/en/pro-app/latest/tool-reference/network-diagram/apply-compression-layout.htm) documentation.
- `ForceDirectedDiagramLayout`: Emphasizes loops contained in a network diagram. For more information see the [ForceDirectedDiagramLayout property set object](/appendix-diagram-layout-property-set-objects#forcedirecteddiagramlayout-property-set-object) documentation or the [Apply Force Directed Layout tool](https://pro.arcgis.com/en/pro-app/latest/tool-reference/network-diagram/apply-force-directed-layout.htm) documentation.
- `GeoPositionsDiagramLayout`: Moves each diagram junction and edge feature so they match the geographical positions of the associated network features. For more information see the [GeoPositionsDiagramLayout property set object](/appendix-diagram-layout-property-set-objects#geopositionsdiagramlayout-property-set-object) documentation or the [Apply Geo Positions Layout tool](https://pro.arcgis.com/en/pro-app/latest/tool-reference/network-diagram/apply-geo-positions-layout.htm) documentation.
- `GridDiagramLayout`: Positions diagram junctions relative to a predefined magnetic grid. For more information see the [GridDiagramLayout property set object](/appendix-diagram-layout-property-set-objects#griddiagramlayout-property-set-object) documentation or the [Apply Grid Layout tool](https://pro.arcgis.com/en/pro-app/latest/tool-reference/network-diagram/apply-grid-layout.htm) documentation.
- `LinearDispatchDiagramLayout`: Adds space between diagram junctions that are visually too close, overlapping, or coincident. For more information see the [LinearDispatchDiagramLayout property set object](/appendix-diagram-layout-property-set-objects#lineardispatchdiagramlayout-property-set-object) documentation or the [Apply Linear Dispatch Layout tool](https://pro.arcgis.com/en/pro-app/latest/tool-reference/network-diagram/apply-linear-dispatch-layout.htm) documentation.
- `MainLineTreeDiagramLayout`: Arranges diagram junctions and edges hierarchically along a main line. For more information see the [MainLineTreeDiagramLayout property set object](/appendix-diagram-layout-property-set-objects#mainlinetreediagramlayout-property-set-object) documentation or the [Apply Mainline Tree Layout tool](https://pro.arcgis.com/en/pro-app/latest/tool-reference/network-diagram/apply-mainline-tree-layout.htm) documentation.
- `MainRingDiagramLayout`: Arranges the diagram features in a network diagram around a main ring. For more information see the [MainRingDiagramLayout property set object](/appendix-diagram-layout-property-set-objects#mainringdiagramlayout-property-set-object) documentation or the [Apply Main Ring Layout tool](https://pro.arcgis.com/en/pro-app/latest/tool-reference/network-diagram/apply-main-ring-layout.htm) documentation.
- `PartialOverlappingEdgesDiagramLayout`: Spaces out collinear edges or collinear portions of edges (edge segments) inside a given buffer zone. For more information see the [PartialOverlappingEdgesDiagramLayout property set object](/appendix-diagram-layout-property-set-objects#partialoverlappingedgesdiagramlayout-property-set-object) documentation or the [Apply Partial Overlapping Edges Layout tool](https://pro.arcgis.com/en/pro-app/latest/tool-reference/network-diagram/apply-partial-overlapping-edges-layout.htm) documentation.
- `RadialTreeDiagramLayout`: Arranges diagram features hierarchically and places them in a radial tree. For more information see the [RadialTreeDiagramLayout property set object](/appendix-diagram-layout-property-set-objects#radialtreediagramlayout-property-set-object) documentation or the [Apply Radial Tree Layout tool](https://pro.arcgis.com/en/pro-app/latest/tool-reference/network-diagram/apply-radial-tree-layout.htm) documentation.
- `RelativeMainlineDiagramLayout`: Arranges the network diagram features in the active diagram along parallel straight lines. For more information see the [RelativeMainlineDiagramLayout property set object](/appendix-diagram-layout-property-set-objects#relativemainlinediagramlayout-property-set-object) documentation or the [Apply Relative Mainline Layout tool](https://pro.arcgis.com/en/pro-app/latest/tool-reference/network-diagram/apply-relative-mainline-layout.htm) documentation.
- `ReshapeEdgesDiagramLayout`: Processes simple operations on vertices along edges. For more information see the [ReshapeEdgesDiagramLayout property set object](/appendix-diagram-layout-property-set-objects#reshapeedgesdiagramlayout-property-set-object) documentation or the [Reshape Diagram Edges Layout tool](https://pro.arcgis.com/en/pro-app/latest/tool-reference/network-diagram/reshape-diagram-edges-layout.htm) documentation.
- `RotateTreeDiagramLayout`: Rotates the tree or trees related to pivot junctions currently set up in a diagram to the specified angle. For more information see the [RotateTreeDiagramLayout property set object](/appendix-diagram-layout-property-set-objects#rotatetreediagramlayout-property-set-object) documentation or the [Apply Rotate Tree Layout tool](https://pro.arcgis.com/en/pro-app/latest/tool-reference/network-diagram/apply-rotate-tree-layout.htm) documentation.
- `SeparateOverlappingEdgesDiagramLayout`: Separates edges that connect the same origin and extremity junctions when they are overlapping. For more information see the [SeparateOverlappingEdgesDiagramLayout property set object](/appendix-diagram-layout-property-set-objects#separateoverlappingedgesdiagramlayout-property-set-object) documentation.
- `SmartTreeDiagramLayout`: Arranges diagram features hierarchically and places them in a smart tree. For more information see the [SmartTreeDiagramLayout property set object](/appendix-diagram-layout-property-set-objects#smarttreediagramlayout-property-set-object) documentation or the [Apply Smart Tree Layout tool](https://pro.arcgis.com/en/pro-app/latest/tool-reference/network-diagram/apply-smart-tree-layout.htm) documentation. 
- `SpatialDispatchDiagramLayout`: Separates diagram junctions that are visibly close to overlapping. For more information see the [SpatialDispatchDiagramLayout property set object](/appendix-diagram-layout-property-set-objects#spatialdispatchdiagramlayout-property-set-object) documentation or the [Apply Spatial Dispatch Layout tool](https://pro.arcgis.com/en/pro-app/latest/tool-reference/network-diagram/apply-spatial-dispatch-layout.htm) documentation. 

Example: `layoutName = ForceDirectedDiagramLayout` 

</StyledTableCell>

</StyledTableRow>

<StyledTableRow>

<StyledTableCell cellStyle="markdown">

`layoutParams` 

</StyledTableCell>

<StyledTableCell cellStyle="markdown">

The algorithm layout parameters property set. 

There is a [specific property set JSON object for each diagram layout parameters](/appendix-diagram-layout-property-set-objects)

Syntax: 

```json
layoutParams = {
 "type": "PropertySet",
 "propertySetItems": ["algoParamName1", <algoParamValue1>, …, "algoParamNameN",<algoParamValueN>]
}
```

 

Example: 

Sample of parameter property set when layoutName = ForceDirectedDiagramLayout

```json
layoutParams = {
   "type": "PropertySet",
   "propertySetItems": [
    "are_containers_preserved",
    false,
    "is_active",
    false,
    "iterations_number",
    20,
    "repel_factor",
    1,
    "degree_freedom",
    1
   ]
  }

```

 

</StyledTableCell>

</StyledTableRow>

<StyledTableRow>

<StyledTableCell cellStyle="markdown">

`junctionObjectIDs` 

</StyledTableCell>

<StyledTableCell cellStyle="markdown">

For the case you want the layout algorithm to apply to a diagram part, a list of junction ObjectIDs (long) that will be processed:

Syntax: `junctionObjectIDs=[<DiagJctOid1>, …, <DiagJctOidN]` 

Example: `junctionObjectIDs=[1,2,3,4,5]` 

</StyledTableCell>

</StyledTableRow>

<StyledTableRow>

<StyledTableCell cellStyle="markdown">

`containerObjectIDs` 

</StyledTableCell>

<StyledTableCell cellStyle="markdown">

For the case you want the layout algorithm to apply to a diagram part, a list of container ObjectIDs (long) that will be processed:

Syntax: `containerObjectIDs=[<DiagConOid1>, …, <DiagConOidN]` 

Example: `containerObjectIDs=[1]` 

</StyledTableCell>

</StyledTableRow>

<StyledTableRow>

<StyledTableCell cellStyle="markdown">

`edgeObjectIDs` 

</StyledTableCell>

<StyledTableCell cellStyle="markdown">

For the case you want the layout algorithm to apply to a diagram part, a list of edge ObjectIDs (long) that will be processed:

Syntax: `edgeObjectIDs=[<DiagEdgOid1>, …, <DiagEdgOidN]` 

Example: `edgeObjectIDs=[1,2,3]` 

</StyledTableCell>

</StyledTableRow>

<StyledTableRow>

<StyledTableCell cellStyle="markdown">

`async` 

</StyledTableCell>

<StyledTableCell cellStyle="markdown">


A boolean statement that specifies whether the layout algorithm will run synchronously or asynchronously.

-   `false`—The layout algorithm will run synchronously and can fail if the process completion exceeds the service timeout—600 seconds by default. This is the default.
-   `true`—The layout algorithm will run asynchronously. This option dedicates server resources to run the layout algorithm with a longer time-out. Running asynchronously can be interesting when applying layout that are time consuming—for example, Partial Overlapping Edges—and applying to large diagrams—more than 25,000 features.

Syntax: `async=<true | false>` 

Example: `async=true` 

</StyledTableCell>

</StyledTableRow>

<StyledTableRow>

<StyledTableCell cellStyle="markdown">

`f` 

</StyledTableCell>

<StyledTableCell cellStyle="markdown">

<GUID_39D57F54_1EBC_4379_8DFC_8A7E3A992DFC_GUID_4631762B_50EE_44C6_9461_38BDDF1BB012 />

<GUID_39D57F54_1EBC_4379_8DFC_8A7E3A992DFC_GUID_7D12F246_BE1B_414F_8A39_8054E24176EB />

</StyledTableCell>

</StyledTableRow>

</StyledTable>

## Example Usage

Applying the SmartTree layout algorithm with its default parameters on the entire DiagramTest2 diagram resource content; this diagram being stored in version ABV1; that is:

-   URL: `https://myserver.esri.com/server/rest/services/Naperville/NetworkDiagramServer/diagrams/DiagramTest2/applyLayout` 
-   Parameters: 

    ```javascript
    gdbVersion=ABV1
    sessionId=
    layoutName=SmartTreeDiagramLayout
    layoutParams=
    junctionObjectIDs=
    containerObjectIDs=
    edgeObjectIDs=
    async=
    f=pjson
    ```

     
-   Sent URL (GET): `https://myserver.esri.com/server/rest/services/Naperville/NetworkDiagramServer/diagrams/DiagramTest2/applyLayout?gdbVersion=ABV1&sessionId=&layoutName=SmartTreeDiagramLayout&layoutParams=&junctionObjectIDs=&containerObjectIDs=&edgeObjectIDs=&async=&f=pjson` 

## JSON Response Syntax

A JSON object composed of a [Diagram JSON Information](/appendix-diagram-information-object-network-diagram-service) object and a moment: `{"diagramInfo": , "moment": <moment>}` 

<Note type={"note"}>

The moment is only returned for a stored diagram.

</Note>

## JSON Response Example

Sample response when synchronously applying a layout

```json
{
 "diagramInfo": {
  "tag": "",
  "isStored": true,
  "canStore": false,
  "canExtend": true,
  "isSystem": false,
  "creator": "acb7352",
  "creationDate": 1505145950000,
  "lastUpdateBy": "acb7352",
  "lastUpdateDate": 1505215730000,
  "containerMargin": 0.5,
  "junctionCount": 10,
  "edgeCount": 12,
  "containerCount": 0,
  "aggregationCount": 0,
  "isHistorical": false,
  "access": "esriDiagramPublicAccess",
  "diagramExtent": {
   "xmin": 6807604.6431991458,
   "ymin": 1848131.8394459635,
   "xmax": 6807794.5801552236,
   "ymax": 1848226.8080880493,
   "spatialReference": {
    "wkid": 3498,
    "latestWkid": 3498
   }
  },
  "networkExtent": {
   "xmin": 6807604.6431991458,
   "ymin": 1847967.7367558032,
   "xmax": 6808661.8976463079,
   "ymax": 1848650.1848659664,
   "spatialReference": {
    "wkid": 3498,
    "latestWkid": 3498
   }
  },
  "name": "DiagramTest2",
  "id": "{856490C7-ED84-44FE-8EC8-5DA4B39365C0}",
  "template": "Basic"
 },
 "moment": 1505217369240
}

```

 

Sample response when asynchronously applying a layout; that is with `async=true` 

```json
{
 "statusUrl": "https://myserver.esri.com/server/rest/services/Naperville/UtilityNetworkServer/jobs/j03f449a0ece143f1bfc6cc676e3c4cca"
}

```

 
